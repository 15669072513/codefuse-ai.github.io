<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="CodeFuse介绍主要功能">
<meta name="author" content="codefuse-ai">

<title>GodelLanguage · CodeFuse-AI</title>

<link rel="canonical" href="/docs/codefuse-query-godellanguage/">









<link rel="stylesheet" href="/scss/base.css" integrity="">



<link rel="stylesheet" href="/scss/theme/default.css" integrity="">



  <link rel="preconnect" href="https://-dsn.algolia.net" crossorigin />
  
  <link rel="stylesheet" href="/scss/component/docsearch.css" integrity=""/>

<link rel="manifest" href="/manifest.json">
<link rel="icon" href="/img/icon/favicon.ico">
<link rel="icon" href="/img/icon/icon-16.png" sizes="16x16" type="image/png">
<link rel="icon" href="/img/icon/icon-32.png" sizes="32x32" type="image/png">
<link rel="apple-touch-icon" href="/img/icon/icon-180.png" sizes="180x180">
<meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#121212" media="(prefers-color-scheme: dark)">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-xxxx"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-xxxx');
</script>


  
  

    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.3/css/all.css">
  </head>
  <body>
    <header id="site-header">
  
  <div id="site-header-brand">
    <a href="/">CodeFuse-AI</a>
  </div>

  
  <div id="site-header-controls">
    
    <div class="dropdown">
      <button class="dropdown-btn" aria-haspopup="menu" aria-label="theme selector">
        <i class="icon icon-brightness"></i>
        <i class="icon icon-select"></i>
      </button>
      <ul role="menu" class="dropdown-menu">
        <li role="menuitem"><button class="color-scheme" data-value="light"><i class="icon icon-light-mode"></i> Light</button></li>
        <li role="menuitem"><button class="color-scheme" data-value="dark"><i class="icon icon-dark-mode"></i> Dark &nbsp;</button></li>
        <li role="menuitem"><button class="color-scheme" data-value="night"><i class="icon icon-night-mode"></i> Night</button></li>
      </ul>
    </div>

    
    <div class="dropdown">
      <button class="dropdown-btn" aria-haspopup="menu" aria-label="language selector">
        <i class="icon icon-translate"></i>
        <i class="icon icon-select"></i>
      </button>
      <ul role="menu" class="dropdown-menu">
        
          
          <li role="menuitem"><a href="/docs/codefuse-query-godellanguage/">English</a></li>
          
          <li role="menuitem"><a href="/docs/codefuse-query-godellanguage-zh/">中文</a></li>
          
        
      </ul>
    </div>
  </div>

  
  <div id="site-header-menu">
    <nav>
      <ul>
        
        
        
          
          <li><a href="/" ><i class='icon icon-home'></i>Home</a></li>
        
          
          <li><a href="/docs"  class="active"><i class='icon icon-book'></i>Overview</a></li>
        
          
          <li><a href="/muagent" ><i class='icon icon-book'></i>MuAgent</a></li>
        
          
          <li><a href="/contribution" ><i class='icon icon-book'></i>Contribution</a></li>
        
      </ul>
    </nav>
  </div>

  
  <div id="site-header-search"></div>
</header>
    
<div id="site-main-content-wrapper">
  
  
    <aside id="sidebar">
  <span class="btn-close"><i class="icon icon-close"></i></span>

  <div class="sticky"><strong class="sidebar-section">📖 CodeFuse-AI Overview</strong>
          
          <a class="sidebar-link " href="/docs/overview/">
            
              overview
            
          </a>

        <strong class="sidebar-section">📖 CodeFuse-AI Module</strong>
          
          <a class="sidebar-link " href="/docs/codefuse-query/">
            
              CodeFuse-Query
            
          </a>

        
          
          <a class="sidebar-link " href="/docs/mftcoder/">
            
              MFTCoder
            
          </a>

        
          
          <a class="sidebar-link " href="/docs/codefuse-mft-vlm/">
            
              CodeFuse-MFT-VLM
            
          </a>

        
          
          <a class="sidebar-link " href="/docs/test-agent/">
            
              Test-Agent
            
          </a>

        
          
          <a class="sidebar-link " href="/docs/codefuse-modelcache/">
            
              CodeFuse-ModelCache
            
          </a>

        
          
          <a class="sidebar-link " href="/docs/codefuse-chatbot/">
            
              CodeFuse-ChatBot
            
          </a>

        
          
          <a class="sidebar-link " href="/docs/codefuse-devops-eval/">
            
              CodeFuse-DevOps-Eval
            
          </a>

        
          
          <a class="sidebar-link " href="/docs/codefuse-devops-model/">
            
              CodeFuse-DevOps-Model
            
          </a>

        
          
          <a class="sidebar-link " href="/docs/codefuse-evalution/">
            
              CodeFuse-Evalution
            
          </a>

        <strong class="sidebar-section">CodeFuse-Query</strong>
          
          <a class="sidebar-link " href="/docs/codefuse-query-introduction/">
            
              Introduction
            
          </a>

        
          
          <a class="sidebar-link " href="/docs/codefuse-query-quickstart/">
            
              QuickStart
            
          </a>

        
          
          <a class="sidebar-link current" href="/docs/codefuse-query-godellanguage/">
            
              GodelLanguage
            
          </a>

        
          
          <a class="sidebar-link " href="/docs/codefuse-query-toolchain/">
            
              Toolchain
            
          </a>

        
          
          <a class="sidebar-link " href="/docs/codefuse-query-usercase/">
            
              UserCase
            
          </a>

        <strong class="sidebar-section">MFTCoder</strong>
          
          <a class="sidebar-link " href="/docs/mftcoder-introduction/">
            
              Introduction
            
          </a>

        
          
          <a class="sidebar-link " href="/docs/mftcoder-quickstart/">
            
              QuickStart
            
          </a>

        
          
          <a class="sidebar-link " href="/docs/mftcoder-accelerate/">
            
              Accelerate &#43; DeepSpeed/FSDP Framework
            
          </a>

        
          
          <a class="sidebar-link " href="/docs/mftcoder-atorch/">
            
              Atorch Framework
            
          </a>

        <strong class="sidebar-section">CodeFuse-MFT-VLM</strong>
          
          <a class="sidebar-link " href="/docs/codefuse-mft-vlm-quickstart/">
            
              QuickStart
            
          </a>

        <strong class="sidebar-section">🌱 Test Agent</strong>
          
          <a class="sidebar-link " href="/docs/test-agent-quickstart/">
            
              QuickStart
            
          </a>

        <strong class="sidebar-section">🌱 CodeFuse-ModelCache</strong>
          
          <a class="sidebar-link " href="/docs/codefuse-modelcache-quickstart/">
            
              QuickStart
            
          </a>

        
          
          <a class="sidebar-link " href="/docs/codefuse-modelcache-feature/">
            
              Feature
            
          </a>

        
          
          <a class="sidebar-link " href="/docs/codefuse-modelcache-config/">
            
              Config
            
          </a>

        
          
          <a class="sidebar-link " href="/docs/codefuse-modelcache-release/">
            
              Release Note
            
          </a>

        <strong class="sidebar-section">🌱 CodeFuse-ChatBot</strong>
          
          <a class="sidebar-link " href="/docs/codefuse-chatbot-quickstart/">
            
              QuickStart
            
          </a>

        
          
          <a class="sidebar-link " href="/docs/start-detail/">
            
              Start-Detail
            
          </a>

        
          
          <a class="sidebar-link " href="/docs/llm-configuration/">
            
              LLM-Configuration
            
          </a>

        
          
          <a class="sidebar-link " href="/docs/chatbot-roadmap/">
            
              ChatBot-RoadMap
            
          </a>

        <strong class="sidebar-section">🌱 CodeFuse-DevOps-Model</strong>
          
          <a class="sidebar-link " href="/docs/codefuse-devops-model-train/">
            
              TrainDetail
            
          </a>

        
          
          <a class="sidebar-link " href="/docs/codefuse-devops-model-quickstart/">
            
              QuickStart
            
          </a>

        <strong class="sidebar-section">🌱 CodeFuse-DevOps-Eval</strong>
          
          <a class="sidebar-link " href="/docs/data/">
            
              Data
            
          </a>

        
          
          <a class="sidebar-link " href="/docs/codefuse-devops-eval-quickstart/">
            
              QuickStart
            
          </a>

        <strong class="sidebar-section">🌱 CodeFuse-evalution</strong>
          
          <a class="sidebar-link " href="/docs/codefuse-evalution-quickstart/">
            
              QuickStart
            
          </a>

        
  </div>
</aside>
  
  <main>
    <article id="article">
      <nav id="article-nav">
  <button id="article-nav-menu-btn"><i class="icon icon-menu"></i> On this section</button>
  
</nav>
      <header id="article-header">
  <h1>GodelLanguage</h1>
</header>
      <div id="article-content">
        
        
        <h1 id="gödelscript-query-language">GödelScript Query Language</h1>
<h2 id="index">Index</h2>
<ul>
<li><a href="#g%C3%B6delscript-basic-concepts-and-syntax">GödelScript Basic Concepts and Syntax</a>
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#basic-program-structure">Basic Program Structure</a></li>
<li><a href="#fundamental-types-and-compiler-built-in-functions">Fundamental Types and Compiler Built-in Functions</a></li>
<li><a href="#functions">Functions</a></li>
<li><a href="#statements">Statements</a></li>
<li><a href="#schema">Schema</a></li>
<li><a href="#database">Database</a></li>
<li><a href="#trait">Trait</a></li>
<li><a href="#import">Import</a></li>
<li><a href="#query">Query</a></li>
<li><a href="#ungrounded-error-unassignedunbound-error">Ungrounded Error: Unassigned/Unbound Error</a></li>
</ul>
</li>
<li><a href="#query-examples">Query Examples</a>
<ul>
<li><a href="#java">Java</a></li>
<li><a href="#python">Python</a></li>
<li><a href="#javascript">JavaScript</a></li>
<li><a href="#xml">XML</a></li>
<li><a href="#go">Go</a></li>
</ul>
</li>
<li><a href="#query-debugging-and-optimization-tips">Query Debugging and Optimization Tips</a>
<ul>
<li><a href="#schema-arguments-causing-excessively-large-cartesian-products">Schema Arguments Causing Excessively Large Cartesian Products</a></li>
<li><a href="#multiple-layers-of-for-causing-excessively-large-cartesian-products">Multiple Layers of <code>for</code> Causing Excessively Large Cartesian Products</a></li>
<li><a href="#avoid-misusing-inline-and-strategies-for-necessary-inline-optimization">Avoid Misusing <code>@inline</code> and Strategies for Necessary Inline Optimization</a></li>
</ul>
</li>
<li><a href="#using-query-scripts-on-a-local-machine">Using Query Scripts on a Local Machine</a></li>
</ul>
<h2 id="basic-concepts-and-syntax-of-gödelscript">Basic Concepts and Syntax of GödelScript</h2>
<h3 id="introduction">Introduction</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="c1">// script
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">fn</span> <span class="nf">hello</span><span class="p">(</span><span class="n">greeting</span>: <span class="nc">string</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">greeting</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;hello world!&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">output</span><span class="p">(</span><span class="n">hello</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>GödelScript， the Gödel query language, is a domain-specific language (DSL) for querying and data processing used by CodeQuery. GödelScript uses syntax similar to Rust, providing strict type checking, convenient type inference, and user-friendly error messages, allowing users to get started quickly.</p>
<p>Main use cases for the GödelScript compiler include:</p>
<ol>
<li>Writing simple or complex queries for users, offering more convenient syntax to improve query writing efficiency.</li>
<li>Providing strict type checking and type inference, offering smarter code modification suggestions.</li>
<li>Offering strict <a href="#ungrounded-error">ungrounded</a> detection to avoid triggering the common Soufflé Ungrounded Error.</li>
<li>Support for Language Server and IDE Extension.</li>
</ol>
<h3 id="basic-program-structure">Basic Program Structure</h3>
<h4 id="program-structure">Program Structure</h4>
<p>A GödelScript program may include:</p>
<ul>
<li><a href="#import">Module and symbol import statements</a></li>
<li><a href="#schema">Schema type declarations</a></li>
<li><a href="#database">Database type declarations</a></li>
<li><a href="#trait">Trait declarations</a></li>
<li><a href="#method-implementation">Method implementations</a></li>
<li><a href="#function">Function declarations and implementations</a></li>
<li><a href="#query">Query declarations</a></li>
</ul>
<p>An example containing all the above components:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="c1">// script
</span></span></span><span class="line"><span class="cl"><span class="c1">// Package import/symbol import
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">use</span><span class="w"> </span><span class="n">coref</span>::<span class="n">java</span>::<span class="o">*</span><span class="w"> </span><span class="c1">// Import all symbols
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">use</span><span class="w"> </span><span class="n">coref</span>::<span class="n">java</span>::<span class="p">{</span><span class="n">JavaDB</span><span class="p">,</span><span class="w"> </span><span class="n">Class</span><span class="p">}</span><span class="w"> </span><span class="c1">// Selective symbol import
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// Function declaration
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">fn</span> <span class="nf">default_db</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">JavaDB</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">JavaDB</span>::<span class="n">load</span><span class="p">(</span><span class="s">&#34;example.db&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// Schema declaration
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">schema</span><span class="w"> </span><span class="n">File</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">@</span><span class="n">primary</span><span class="w"> </span><span class="n">id</span>: <span class="nc">int</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// Database declaration
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">database</span><span class="w"> </span><span class="n">NewDB</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">file</span>: <span class="o">*</span><span class="n">File</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// Trait declaration
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">trait</span><span class="w"> </span><span class="n">FileTrait</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">getId</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">int</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// Impl trait for
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">impl</span><span class="w"> </span><span class="n">FileTrait</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">File</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">getId</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">int</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// Impl
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">impl</span><span class="w"> </span><span class="n">File</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">@</span><span class="n">data_constraint</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">all</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="o">*</span><span class="n">File</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kr">yield</span><span class="w"> </span><span class="n">File</span><span class="w"> </span><span class="p">{</span><span class="n">id</span>: <span class="mi">1</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kr">yield</span><span class="w"> </span><span class="n">File</span><span class="w"> </span><span class="p">{</span><span class="n">id</span>: <span class="mi">2</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// Query
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">query</span><span class="w"> </span><span class="n">get_all_anno</span><span class="w"> </span><span class="n">from</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">Annotation</span><span class="w"> </span><span class="n">anno</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Annotation</span><span class="p">(</span><span class="n">default_db</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">select</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">anno</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">id</span><span class="w">
</span></span></span></code></pre></div><h4 id="comments">Comments</h4>
<p>GödelScript uses comment syntax similar to C-like languages.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="c1">// Single line comment
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="cm">/*
</span></span></span><span class="line"><span class="cl"><span class="cm">* 1. Multi-line comment
</span></span></span><span class="line"><span class="cl"><span class="cm">* 2. Multi-line comment
</span></span></span><span class="line"><span class="cl"><span class="cm">*/</span><span class="w">
</span></span></span></code></pre></div><h4 id="the-main-function">The <code>main</code> Function</h4>
<p>A GödelScript query script can include a <code>main</code> function, which has no return value. If the <code>main</code> function is not implemented and no query declarations are written, the program will not produce any output.</p>
<p>For more details, please refer to <a href="#g%C3%B6delscript-main-function">main function</a>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">output</span><span class="p">(</span><span class="n">query_1</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">output</span><span class="p">(</span><span class="n">query_2</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h3 id="basic-types-and-built-in-compiler-functions">Basic Types and Built-in Compiler Functions</h3>
<p>GödelScript includes basic types <code>int</code>, <code>string</code>, and <code>bool</code>. <code>bool</code> is a basic type but cannot be stored as a value.</p>
<h4 id="int-type-native-functions"><code>int</code> Type Native Functions</h4>
<table>
<thead>
<tr>
<th>Function</th>
<th>Type</th>
<th>Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td>pow</td>
<td>(int, int) -&gt; int</td>
<td>Exponentiation. Arguments must be non-negative numbers.</td>
</tr>
<tr>
<td>rem</td>
<td>(int, int) -&gt; int</td>
<td>Remainder operation.</td>
</tr>
<tr>
<td>bitand</td>
<td>(int, int) -&gt; int</td>
<td>Bitwise conjunction.</td>
</tr>
<tr>
<td>bitor</td>
<td>(int, int) -&gt; int</td>
<td>Bitwise disjunction.</td>
</tr>
<tr>
<td>bitxor</td>
<td>(int, int) -&gt; int</td>
<td>Bitwise exclusive disjunction.</td>
</tr>
<tr>
<td>bitnot</td>
<td>(int) -&gt; int</td>
<td>Bitwise negation.</td>
</tr>
<tr>
<td>neg</td>
<td>(int) -&gt; int</td>
<td>Arithmetic negation.</td>
</tr>
<tr>
<td>to_string</td>
<td>(int) -&gt; string</td>
<td>Conversion to a string.</td>
</tr>
<tr>
<td>add</td>
<td>(int, int) -&gt; int</td>
<td>Addition (+).</td>
</tr>
<tr>
<td>sub</td>
<td>(int, int) -&gt; int</td>
<td>Subtraction (-).</td>
</tr>
<tr>
<td>mul</td>
<td>(int, int) -&gt; int</td>
<td>Multiplication (*).</td>
</tr>
<tr>
<td>div</td>
<td>(int, int) -&gt; int</td>
<td>Division (/).</td>
</tr>
<tr>
<td>eq</td>
<td>(int, int) -&gt; bool</td>
<td>Equality (=).</td>
</tr>
<tr>
<td>ne</td>
<td>(int, int) -&gt; bool</td>
<td>Inequality (!=).</td>
</tr>
<tr>
<td>gt</td>
<td>(int, int) -&gt; bool</td>
<td>Greater than (&gt;).</td>
</tr>
<tr>
<td>ge</td>
<td>(int, int) -&gt; bool</td>
<td>Greater than or equal to (&gt;=).</td>
</tr>
<tr>
<td>lt</td>
<td>(int, int) -&gt; bool</td>
<td>Less than (&lt;).</td>
</tr>
<tr>
<td>le</td>
<td>(int, int) -&gt; bool</td>
<td>Less than or equal to (&lt;=).</td>
</tr>
<tr>
<td>to_set</td>
<td>(int) -&gt; *int</td>
<td>Cast to a set type.</td>
</tr>
</tbody>
</table>
<h4 id="string-type-native-functions"><code>string</code> Type Native Functions</h4>
<table>
<thead>
<tr>
<th>Function</th>
<th>Type</th>
<th>Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td>len</td>
<td>(string) -&gt; int</td>
<td>Gets the length of a string.</td>
</tr>
<tr>
<td>substr</td>
<td>(string, int, int) -&gt; string</td>
<td>Substring extraction using initial index and length.</td>
</tr>
<tr>
<td>contains</td>
<td>(string, string) -&gt; bool</td>
<td>Checks if one string is contained within the current string.</td>
</tr>
<tr>
<td>matches</td>
<td>(string, string) -&gt; bool</td>
<td>Checks if a regular expression fully matches the current string.</td>
</tr>
<tr>
<td>get_regex_match_result</td>
<td>(string, string, int) -&gt; string</td>
<td>Gets a capture result from a full regex match on the current string, determined by the second parameter (int). For example, &ldquo;abcdef&rdquo;.get_regex_match_result(&ldquo;a(.*)f&rdquo;, 1) yields &ldquo;bcde&rdquo;.</td>
</tr>
<tr>
<td>to_int</td>
<td>(string) -&gt; int</td>
<td>Converts to an integer.</td>
</tr>
<tr>
<td>add</td>
<td>(string, string) -&gt; string</td>
<td>String concatenation.</td>
</tr>
<tr>
<td>eq</td>
<td>(string, string) -&gt; bool</td>
<td>Checks string equality.</td>
</tr>
<tr>
<td>ne</td>
<td>(string, string) -&gt; bool</td>
<td>Checks string inequality.</td>
</tr>
<tr>
<td>to_set</td>
<td>(string) -&gt; *string</td>
<td>Cast to a set type.</td>
</tr>
</tbody>
</table>
<h4 id="bool-type-native-functions"><code>bool</code> Type Native Functions</h4>
<p>While <code>bool</code> exists as a basic type, it cannot be used as data in intermediate calculations, only as a conditional result.</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Type</th>
<th>Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td>not</td>
<td>(bool) -&gt; bool</td>
<td>Logical negation.</td>
</tr>
<tr>
<td>and</td>
<td>(bool, bool) -&gt; bool</td>
<td>Logical conjunction.</td>
</tr>
<tr>
<td>or</td>
<td>(bool, bool) -&gt; bool</td>
<td>Logical disjunction.</td>
</tr>
<tr>
<td>eq</td>
<td>(bool, bool) -&gt; bool</td>
<td>Equality.</td>
</tr>
<tr>
<td>ne</td>
<td>(bool, bool) -&gt; bool</td>
<td>Inequality.</td>
</tr>
</tbody>
</table>
<h4 id="native-functions-for-sets">Native Functions for Sets</h4>
<table>
<thead>
<tr>
<th>Function</th>
<th>Type</th>
<th>Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td>len</td>
<td>(*T) -&gt; int</td>
<td>Gets the count of a data set.</td>
</tr>
<tr>
<td>max</td>
<td>(*int) -&gt; int</td>
<td>Finds the maximum value.</td>
</tr>
<tr>
<td>min</td>
<td>(*int) -&gt; int</td>
<td>Finds the minimum value.</td>
</tr>
<tr>
<td>sum</td>
<td>(*int) -&gt; int</td>
<td>Summation of the values.</td>
</tr>
<tr>
<td>find</td>
<td>(*T0) -&gt; T1</td>
<td>Finds a data entry from a set using a primary key.</td>
</tr>
</tbody>
</table>
<h4 id="global-native-functions">Global Native Functions</h4>
<table>
<thead>
<tr>
<th>Function</th>
<th>Type</th>
<th>Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td>output</td>
<td>((&hellip;) -&gt; bool) -&gt; <null-type></td>
<td>Outputs query content.</td>
</tr>
</tbody>
</table>
<h4 id="database-native-functions">Database Native Functions</h4>
<table>
<thead>
<tr>
<th>Function</th>
<th>Type</th>
<th>Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td>load</td>
<td>(string) -&gt; T</td>
<td>Loads the database.</td>
</tr>
</tbody>
</table>
<h4 id="schema-native-functions">Schema Native Functions</h4>
<table>
<thead>
<tr>
<th>Function</th>
<th>Type</th>
<th>Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td>to<T></td>
<td>(self) -&gt; T</td>
<td>Converts to another schema type, using duck typing.</td>
</tr>
<tr>
<td>is<T></td>
<td>(self) -&gt; bool</td>
<td>Determines if it can be another schema type, using duck typing. If the schema has a primary key, the underlying check will only use the primary key to determine compatibility.</td>
</tr>
<tr>
<td>key_eq</td>
<td>(self, T) -&gt; bool</td>
<td>Checks if the primary keys of two schema instances are equal.</td>
</tr>
<tr>
<td>key_neq</td>
<td>(self, T) -&gt; bool</td>
<td>Checks if the primary keys of two schema instances are <strong>not</strong> equal.</td>
</tr>
</tbody>
</table>
<p>Schema native function example:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">use</span><span class="w"> </span><span class="n">coref</span>::<span class="n">java</span>::<span class="o">*</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">default_java_db</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">JavaDB</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">JavaDB</span>::<span class="n">load</span><span class="p">(</span><span class="s">&#34;coref_java_src.db&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">example</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">stmt</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">StatementParent</span><span class="p">(</span><span class="n">default_java_db</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">stmt</span><span class="p">.</span><span class="n">is</span><span class="o">&lt;</span><span class="n">ElementParent</span><span class="o">&gt;</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">convert</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="o">*</span><span class="n">ElementParent</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">stmt</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">StatementParent</span><span class="p">(</span><span class="n">default_java_db</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kr">yield</span><span class="w"> </span><span class="n">stmt</span><span class="p">.</span><span class="n">to</span><span class="o">&lt;</span><span class="n">ElementParent</span><span class="o">&gt;</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h3 id="functions">Functions</h3>
<h4 id="the-main-function-of-gödelscript">The <code>main</code> Function of GödelScript</h4>
<p>The main function is the only function in GödelScript that does not declare a return type. The main function only allows the use of output, and other statements will result in a compilation error. Using output(&hellip;) multiple times can output multiple query results, which will be displayed in separate tables, with the table names corresponding to the names of the query functions called within output.</p>
<h4 id="query-functions">Query Functions</h4>
<p>Query functions are recommended to have a <code>bool</code> return type and need to use <code>output()</code> to output query results.</p>
<p>The query functions called within <code>output()</code> are no longer invoked in the conventional manner of passing arguments to functions. At this point, the parameter list changes to represent the table schema of the output table. Here are two examples of how query functions are applied:</p>
<ol>
<li>
<p>Single-table <code>output</code></p>
<p>A single-table <code>output</code> specifically refers to using <code>output</code> only once within the <code>main</code> function to produce output.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">fn</span> <span class="nf">example</span><span class="p">(</span><span class="n">a</span>: <span class="nc">int</span><span class="p">,</span><span class="w"> </span><span class="n">b</span>: <span class="nc">string</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="o">..</span><span class="p">.}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">output</span><span class="p">(</span><span class="n">example</span><span class="p">())</span><span class="w"> </span><span class="c1">// At this point, the parameter list becomes the output table schema and requires no arguments
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>The corresponding output table schema would be:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span><span class="nt">&#34;a&#34;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nt">&#34;b&#34;</span><span class="p">:</span> <span class="s2">&#34;xxx&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span><span class="nt">&#34;a&#34;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nt">&#34;b&#34;</span><span class="p">:</span> <span class="s2">&#34;xxx&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span>
</span></span></code></pre></div></li>
<li>
<p>Multi-table <code>output</code></p>
<p>A multi-table <code>output</code> refers to using <code>output</code> multiple times within the <code>main</code> function to produce output. In this case, the output data will include corresponding table names.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">fn</span> <span class="nf">example0</span><span class="p">(</span><span class="n">a</span>: <span class="nc">int</span><span class="p">,</span><span class="w"> </span><span class="n">b</span>: <span class="nc">string</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="o">..</span><span class="p">.}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">example1</span><span class="p">(</span><span class="n">a</span>: <span class="nc">string</span><span class="p">,</span><span class="w"> </span><span class="n">b</span>: <span class="nc">int</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="o">..</span><span class="p">.}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">output</span><span class="p">(</span><span class="n">example0</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">output</span><span class="p">(</span><span class="n">example1</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>The corresponding output table schema would be:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;example0&#34;</span><span class="p">:[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span><span class="nt">&#34;a&#34;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nt">&#34;b&#34;</span><span class="p">:</span> <span class="s2">&#34;xxx&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span><span class="nt">&#34;a&#34;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nt">&#34;b&#34;</span><span class="p">:</span> <span class="s2">&#34;xxx&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;example1&#34;</span><span class="p">:[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span><span class="nt">&#34;a&#34;</span><span class="p">:</span> <span class="s2">&#34;xxx&#34;</span><span class="p">,</span> <span class="nt">&#34;b&#34;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span><span class="nt">&#34;a&#34;</span><span class="p">:</span> <span class="s2">&#34;xxx&#34;</span><span class="p">,</span> <span class="nt">&#34;b&#34;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div></li>
</ol>
<p>Below is a more detailed example where we directly construct two sets of data for output. In the following code, note that:</p>
<ol>
<li>
<p>In GödelScript, boolean values can be represented with the keywords <code>true</code> and <code>false</code>.</p>
</li>
<li>
<p>The <code>=</code> symbol in GödelScript is quite special and should not be interpreted in the same way as in conventional programming languages. GödelScript is a Datalog language. Here, the <code>=</code> symbol carries dual semantics: both <strong>assignment</strong> and <strong>equality comparison</strong>. Details can be found in <a href="#assignment-and-equality-comparison-operator"><code>=</code> operator</a>.</p>
</li>
<li>
<p>In the conditional statements of this example, both <code>a</code> and <code>b</code> use the assignment semantics of <code>=</code>, because the <code>int</code> and <code>string</code> type parameters are considered <code>ungrounded (unassigned/unbound)</code> within the function body and must be assigned before they can be used.</p>
</li>
<li>
<p>The return value of the <code>=</code> assignment statement is <code>true</code>.</p>
</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">fn</span> <span class="nf">example</span><span class="p">(</span><span class="n">a</span>: <span class="nc">int</span><span class="p">,</span><span class="w"> </span><span class="n">b</span>: <span class="nc">string</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// The = symbol serves both assignment and comparison purposes, depending on whether the left-hand value has been &#34;assigned&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="c1">// Here, the = symbols for a and b are used with assignment semantics
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;1&#34;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// GödelScript uses the keywords true and false to represent boolean values
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;2&#34;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">output</span><span class="p">(</span><span class="n">example</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>The expected output should be:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span><span class="nt">&#34;a&#34;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nt">&#34;b&#34;</span><span class="p">:</span> <span class="s2">&#34;1&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span><span class="nt">&#34;a&#34;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="nt">&#34;b&#34;</span><span class="p">:</span> <span class="s2">&#34;2&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span>
</span></span></code></pre></div><h4 id="regular-functions">Regular Functions</h4>
<p>Regular functions are used to encapsulate complex processes, and these functions must have a clear return type.
There are two possible return types:</p>
<ol>
<li>A single return value, followed by a declaration of the return type after the arrow.</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">fn</span> <span class="nf">getFile</span><span class="p">(</span><span class="n">c</span>: <span class="nc">Class</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">File</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">c</span><span class="p">.</span><span class="n">getRelativePath</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><ol start="2">
<li>A set of return values, the return type after the arrow needs to be prefixed with <code>*</code> to indicate it&rsquo;s a set.</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">fn</span> <span class="nf">getAllFiles</span><span class="p">(</span><span class="n">db</span>: <span class="nc">JavaDB</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="o">*</span><span class="n">File</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">f</span>: <span class="nc">File</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">File</span><span class="p">(</span><span class="n">db</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kr">yield</span><span class="w"> </span><span class="n">f</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>Generally, <code>return</code> is used for functions with a single return value, while <code>yield</code> is used for functions returning a set.
In practice, since GödelScript uses the Datalog engine underneath, all operations are based on sets; a single return value actually only means that the returned set may contain only one data item, but it could also contain multiple items.</p>
<h3 id="statements">Statements</h3>
<h4 id="for-statement-declaring-variables-from-a-set"><code>for</code> Statement: Declaring Variables from a Set</h4>
<p>GödelScript uses the <code>for</code> keyword and syntax similar to loop statements to declare variables from a set:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">for</span><span class="p">(</span><span class="n">f</span>: <span class="nc">File</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">getAllFiles</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">..</span><span class="p">.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>The type after the colon for <code>f: File</code> can be omitted.
The <code>for</code> statement allows the direct definition of multiple variables, where subsequent variables can use all previously defined variables in the same statement during initialization:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">for</span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">XmlAttribute</span><span class="p">(</span><span class="n">db</span><span class="p">),</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">XmlAttribute</span><span class="p">(</span><span class="n">db</span><span class="p">),</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">XmlElement</span><span class="p">(</span><span class="n">db</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">..</span><span class="p">.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">for</span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">getAllFiles</span><span class="p">(),</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">getAllPaths</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">..</span><span class="p">.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h4 id="let-statement-declaring-a-single-variable"><code>let</code> Statement: Declaring a Single Variable</h4>
<p>GödelScript uses the <code>let</code> keyword to declare a single/intermediate variable:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="kd">let</span><span class="p">(</span><span class="n">f</span>: <span class="nc">File</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="p">.</span><span class="n">getRelativePath</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">..</span><span class="p">.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>The type after the colon for <code>f: File</code> can be omitted.
The <code>let</code> statement allows the direct definition of multiple variables, where subsequent variables can use all previously defined variables in the same statement during initialization:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="kd">let</span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">..</span><span class="p">.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h4 id="if-statement"><code>if</code> Statement</h4>
<p>Conditional statements in GödelScript are similar to many procedural programming languages:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">getName</span><span class="p">().</span><span class="n">contains</span><span class="p">(</span><span class="s">&#34;util&#34;</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">f</span><span class="p">.</span><span class="n">getName</span><span class="p">().</span><span class="n">contains</span><span class="p">(</span><span class="s">&#34;com&#34;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">..</span><span class="p">.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>Conditions can be connected using logical operators: <code>!</code> for NOT, <code>||</code> for OR, and <code>&amp;&amp;</code> for AND.</p>
<p>Comparative operators in conditions: <code>&gt;</code> for greater than, <code>&lt;</code> for less than, <code>&gt;=</code> for greater than or equal to, <code>&lt;=</code> for less than or equal to, <code>=</code> for equal to or assignment, <code>!=</code> for not equal to.</p>
<p>Regular arithmetic operations can use the following operators: <code>+</code> for addition, <code>-</code> for subtraction/negation, <code>*</code> for multiplication, <code>/</code> for division.</p>
<h5 id="assignment-and-equality-comparison-operator-">Assignment and Equality Comparison Operator <code>=</code></h5>
<p>The <code>=</code> symbol in GödelScript carries two different semantics: assignment and equality comparison. The specific semantics need to be discussed based on the context:</p>
<ol>
<li>
<p>Assignment</p>
<p>Assignment generally occurs with fundamental type variables such as <code>int</code> and <code>string</code>. These variables, when used as function parameters, are typically considered unassigned. When a function with such variables is called, the parameters passed in actually serve as filtering conditions.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">fn</span> <span class="nf">example</span><span class="p">(</span><span class="n">a</span>: <span class="nc">int</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// This is somewhat counterintuitive; in procedural languages, this is usually taken to mean a == 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="c1">// However, in Datalog dialects, each function in Datalog is essentially calculating an intermediate table (view)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="c1">// So this function is essentially generating a view with data [{&#34;a&#34;: 1}]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="c1">// assign a = 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">test</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// Although it seems like we are passing a parameter to make a = 2, it&#39;s not really the case
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="c1">// example() itself returns the view: [{&#34;a&#34;: 1}]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="c1">// Then it is constrained by a = 2, and as you can see, we don&#39;t get any result here
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="c1">// So it returns false
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">example</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="c1">// false
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div></li>
<li>
<p>Equality Comparison</p>
<p>For schema types, since each schema type has a universe behind it, schema type parameters in the parameter list are generally considered to have been assigned. For variables that have already been assigned, <code>=</code> operates as an equality comparison.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="c1">// Declare schema
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">schema</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">{</span><span class="o">..</span><span class="p">.}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// Implement schema member functions
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">impl</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// Here we define the universe for schema A
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="o">@</span><span class="n">data_constraint</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span> <span class="nf">__all__</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="o">*</span><span class="n">A</span><span class="w"> </span><span class="p">{</span><span class="o">..</span><span class="p">.}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">example</span><span class="p">(</span><span class="n">a</span>: <span class="nc">A</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">temp</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">A</span>::<span class="n">__all__</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>Similarly, for internally declared <code>int</code> or <code>string</code> with initial values, <code>=</code> also operates as an equality comparison.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">fn</span> <span class="nf">example</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// assign a = 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// compare a = 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div></li>
</ol>
<h4 id="match-statement"><code>match</code> Statement</h4>
<p>GödelScript allows writing <code>match</code> statements for <code>int</code> and <code>string</code> types. A <code>match</code> statement is similar to a <code>switch</code> statement with multiple conditional branches, and the conditions in the <code>match</code> must be literals:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">match</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="mi">1</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="mi">2</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="mi">3</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">10</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h4 id="return-statements">Return Statements</h4>
<p>GödelScript uses <code>return</code> and <code>yield</code>. <code>return</code> is for functions with a single return value, and <code>yield</code> is for returning sets.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">fn</span> <span class="nf">a</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">int</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">b</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="o">*</span><span class="n">int</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="kr">yield</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="kr">yield</span><span class="w"> </span><span class="mi">2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="kr">yield</span><span class="w"> </span><span class="mi">3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h3 id="schema">Schema</h3>
<p>Schema is a structure for complex data tables in GödelScript.</p>
<h4 id="structure-declaration">Structure Declaration</h4>
<p>GödelScript uses the <code>schema</code> keyword to declare a table structure:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="n">schema</span><span class="w"> </span><span class="n">File</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">id</span>: <span class="nc">int</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">name</span>: <span class="nc">string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>If a field exists as a primary key in the database, you can use the <code>@primary</code> annotation to indicate that it&rsquo;s a primary key:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="n">schema</span><span class="w"> </span><span class="n">File</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">@</span><span class="n">primary</span><span class="w"> </span><span class="n">id</span>: <span class="nc">int</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">name</span>: <span class="nc">string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p><strong>Table structures with a primary key significantly improve query speed, so try to bind a primary key, preferably of type <code>int</code>.</strong></p>
<h4 id="method-implementation">Method Implementation</h4>
<p>GödelScript declares and implements methods related to <code>schema</code> as follows:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">impl</span><span class="w"> </span><span class="n">File</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// Static method
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="k">fn</span> <span class="nf">f1</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="o">..</span><span class="p">.</span><span class="w"> </span><span class="p">{</span><span class="o">..</span><span class="p">.}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="c1">// Member method, the first argument must be self
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">	</span><span class="k">fn</span> <span class="nf">f2</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="o">..</span><span class="p">.</span><span class="w"> </span><span class="p">{</span><span class="o">..</span><span class="p">.}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="o">..</span><span class="p">.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h5 id="static-methods">Static Methods</h5>
<p>Static methods do not require <code>self</code> as the first argument and are straightforward to use: <code>ClassName::MethodName(...)</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">impl</span><span class="w"> </span><span class="n">File</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">getSchemaName</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">string</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&#34;File&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">out</span><span class="p">(</span><span class="n">t</span>: <span class="nc">string</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">File</span>::<span class="n">getSchemaName</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h5 id="member-methods">Member Methods</h5>
<p>The first argument for member methods must be <code>self</code>, without specifying its type. These functions are called using <code>InstanceName.FunctionName(...)</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">impl</span><span class="w"> </span><span class="n">File</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">getName</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">string</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">name</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">out</span><span class="p">(</span><span class="n">path</span>: <span class="nc">string</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">db</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">JavaDB</span>::<span class="n">load</span><span class="p">(</span><span class="s">&#34;coref_java_src.db&#34;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">f</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">File</span>::<span class="n">__all__</span><span class="p">(</span><span class="n">db</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">.</span><span class="n">getName</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h5 id="data-loading-method-fn-__all__db">Data Loading Method <code>fn __all__(db)</code></h5>
<p>A <code>schema</code> can contain a special <strong>static method</strong> for loading its dataset from the database.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">impl</span><span class="w"> </span><span class="n">File</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">@</span><span class="n">data_constraint</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">__all__</span><span class="p">(</span><span class="n">db</span>: <span class="nc">JavaDB</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="o">*</span><span class="n">File</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="o">..</span><span class="p">.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>This method must contain the special annotation <code>@data_constraint</code>, indicating that it is specialized for loading. Without this annotation, the method will return an <strong>empty set</strong>. The return type must be a set of itself.</p>
<p>A <code>schema</code> that includes this method can use syntactic sugar to get its full set:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">fn</span> <span class="nf">out</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">f</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">File</span><span class="p">(</span><span class="n">JavaDB</span>::<span class="n">load</span><span class="p">(</span><span class="s">&#34;...&#34;</span><span class="p">)))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="o">..</span><span class="p">.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">..</span><span class="p">.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// Equivalent to
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">fn</span> <span class="nf">out</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">f</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">File</span>::<span class="n">__all__</span><span class="p">(</span><span class="n">JavaDB</span>::<span class="n">load</span><span class="p">(</span><span class="s">&#34;...&#34;</span><span class="p">)))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="o">..</span><span class="p">.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">..</span><span class="p">.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h5 id="custom-full-set-method">Custom Full Set Method</h5>
<p>A <code>schema</code> allows using static methods with different names than <code>__all__</code> to indicate that some sets also exist within its full set. This method must also contain the special annotation <code>@data_constraint</code>. This method is generally used to manually add some data to the full set of that type.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">impl</span><span class="w"> </span><span class="n">File</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">@</span><span class="n">data_constraint</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">extend_example</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="o">*</span><span class="n">File</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kr">yield</span><span class="w"> </span><span class="n">File</span><span class="w"> </span><span class="p">{</span><span class="n">id</span>: <span class="mi">1234567</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h4 id="constructing-anonymous-instances">Constructing Anonymous Instances</h4>
<p>GödelScript allows for the creation of anonymous instances with a specific syntax. The creation of anonymous instances is contingent on the instance existing within the full set of the <code>schema</code>, unless this usage appears within a <code>@data_constraint</code> method, in which case the result will be empty.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="n">schema</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">@</span><span class="n">primary</span><span class="w"> </span><span class="n">id</span>: <span class="nc">int</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">name</span>: <span class="nc">string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>The corresponding syntax to create an anonymous instance is as follows:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="n">A</span><span class="w"> </span><span class="p">{</span><span class="n">id</span>: <span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">name</span>: <span class="s">&#34;first&#34;</span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h4 id="schema-inheritance">Schema Inheritance</h4>
<p>Schema inheritance in GödelScript is very straightforward, exemplified as follows:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="n">schema</span><span class="w"> </span><span class="n">MyFile</span><span class="w"> </span><span class="n">extends</span><span class="w"> </span><span class="n">File</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span></span></span></code></pre></div><h5 id="parent-field-inheritance">Parent Field Inheritance</h5>
<p>The subclass will inherit all fields from the parent class by default, so there is no need to manually rewrite them.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="n">schema</span><span class="w"> </span><span class="n">File</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">@</span><span class="n">primary</span><span class="w"> </span><span class="n">id</span>: <span class="nc">int</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">name</span>: <span class="nc">string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">schema</span><span class="w"> </span><span class="n">MyFile</span><span class="w"> </span><span class="n">extends</span><span class="w"> </span><span class="n">File</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span></span></span></code></pre></div><h5 id="parent-method-inheritance">Parent Method Inheritance</h5>
<p>The subclass will inherit all methods from the parent class by default, except for those marked with <code>@data_constraint</code>. There is no need to manually rewrite them. However, the <code>__all__</code> method is special and will not be inherited, so you need to rewrite the <code>__all__</code> method to determine the full set of the inherited schema.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="n">schema</span><span class="w"> </span><span class="n">File</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">@</span><span class="n">primary</span><span class="w"> </span><span class="n">id</span>: <span class="nc">int</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">name</span>: <span class="nc">string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">impl</span><span class="w"> </span><span class="n">File</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">@</span><span class="n">data_constraint</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">__all__</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="o">*</span><span class="n">File</span><span class="w"> </span><span class="p">{</span><span class="o">..</span><span class="p">.}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">fn</span> <span class="nf">getId</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">int</span><span class="w"> </span><span class="p">{</span><span class="o">..</span><span class="p">.}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">staticMethod</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">string</span><span class="w"> </span><span class="p">{</span><span class="k">return</span><span class="w"> </span><span class="s">&#34;File&#34;</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">schema</span><span class="w"> </span><span class="n">MyFile</span><span class="w"> </span><span class="n">extends</span><span class="w"> </span><span class="n">File</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span></span></span></code></pre></div><h5 id="method-override">Method Override</h5>
<p>If the subclass implementation contains a method with the same name as the parent class, the parent method will be <strong>overridden</strong> by the subclass method.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="n">schema</span><span class="w"> </span><span class="n">File</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">@</span><span class="n">primary</span><span class="w"> </span><span class="n">id</span>: <span class="nc">int</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">name</span>: <span class="nc">string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">impl</span><span class="w"> </span><span class="n">File</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">staticMethod</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">string</span><span class="w"> </span><span class="p">{</span><span class="k">return</span><span class="w"> </span><span class="s">&#34;File&#34;</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">schema</span><span class="w"> </span><span class="n">MyFile</span><span class="w"> </span><span class="n">extends</span><span class="w"> </span><span class="n">File</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">impl</span><span class="w"> </span><span class="n">MyFile</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">staticMethod</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">string</span><span class="w"> </span><span class="p">{</span><span class="k">return</span><span class="w"> </span><span class="s">&#34;MyFile&#34;</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>In this case, <code>File::staticMethod</code> is overridden by <code>MyFile::staticMethod</code>, so when calling the subclass method, the result obtained will be <code>&quot;MyFile&quot;</code>.</p>
<h3 id="database">Database</h3>
<h4 id="database-declaration">Database Declaration</h4>
<p>The declaration format for databases is as follows:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="n">database</span><span class="w"> </span><span class="n">DatabaseName</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// table_name corresponds to the real table name in the db
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="c1">// GodelSchemaType corresponds to the schema in which the table data is stored after reading into godel
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="n">table_name</span><span class="w"> </span>: <span class="o">*</span><span class="n">GodelSchemaType</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>Before the colon is the <strong>real table name</strong> in the loaded database; after the colon is the <strong>data table format</strong>, which must be a <code>schema</code> type.
For example, if a table called <code>annotation</code> exists in the db and corresponds to the <code>Annotation</code> schema, the declaration would be:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="n">database</span><span class="w"> </span><span class="n">JavaDB</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// Reads data from the db&#39;s annotation table and stores it in Annotation
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="n">annotation</span><span class="w"> </span>: <span class="o">*</span><span class="n">Annotation</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>Additionally, it is necessary to ensure that the <code>Annotation</code> structure matches the table structure. For example:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="n">schema</span><span class="w"> </span><span class="n">Annotation</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">@</span><span class="n">primary</span><span class="w"> </span><span class="n">id</span>: <span class="nc">int</span><span class="p">,</span><span class="w"> </span><span class="c1">// The primary annotation indicates that this field is the primary key; a table can also have no primary key
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="n">content</span>: <span class="nc">string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>The <code>annotation</code> table must contain <code>id</code> and <code>content</code> fields with corresponding storage types.</p>
<h4 id="database-loading">Database Loading</h4>
<p>Database types have a static method <code>(database)::load(filename: string)</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">fn</span> <span class="nf">loadDatabaseExample</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// The string passed to load is the db&#39;s filename, not the path
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="c1">// The db&#39;s path will be passed as a command-line argument when executing godel
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">db</span>: <span class="nc">JavaDB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">JavaDB</span>::<span class="n">load</span><span class="p">(</span><span class="s">&#34;...&#34;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="o">..</span><span class="p">.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h4 id="data-table-access">Data Table Access</h4>
<p>In the example above, to access the <code>annotation</code> table:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">fn</span> <span class="nf">getAnnotation</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">Annotation</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// The string passed to load is the db&#39;s filename, not the path
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="c1">// The db&#39;s path will be passed as a command-line argument when executing godel
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">db</span>: <span class="nc">JavaDB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">JavaDB</span>::<span class="n">load</span><span class="p">(</span><span class="s">&#34;...&#34;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// Directly use db.field to access the table data
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">anno</span>: <span class="nc">Annotation</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">db</span><span class="p">.</span><span class="n">annotation</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="o">..</span><span class="p">.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h3 id="trait">Trait</h3>
<h4 id="trait-declaration">Trait Declaration</h4>
<p>The syntax for declaring a <code>trait</code> is as follows:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">trait</span><span class="w"> </span><span class="n">Example</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">getId</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">int</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">getName</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">string</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">getValueByName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">name</span>: <span class="nc">string</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">string</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h4 id="impl-trait">Impl Trait</h4>
<p>The syntax is similar to <code>impl</code>, but you must implement all the functions declared in the <code>trait</code> to pass compilation.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">impl</span><span class="w"> </span><span class="n">Example</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">XmlElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">getId</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">int</span><span class="w"> </span><span class="p">{</span><span class="k">return</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">id</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">getName</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">int</span><span class="w"> </span><span class="p">{</span><span class="k">return</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">name</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">getValueByName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">name</span>: <span class="nc">string</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">int</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="n">attr</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">XmlAttribute</span><span class="p">(</span><span class="n">XmlDB</span>::<span class="n">load</span><span class="p">(</span><span class="s">&#34;...&#34;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">attr</span><span class="p">.</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">attr</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">getAttribute</span><span class="p">().</span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">attr</span><span class="p">.</span><span class="n">getValue</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h3 id="import">Import</h3>
<p>GödelScript uses the <code>use</code> keyword to import symbols from other files:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">use</span><span class="w"> </span><span class="n">coref</span>::<span class="n">java</span>::<span class="o">*</span><span class="w"> </span><span class="c1">// Import all symbols
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">use</span><span class="w"> </span><span class="n">coref</span>::<span class="n">xml</span>::<span class="n">Location</span><span class="w"> </span><span class="c1">// Import a single symbol
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">use</span><span class="w"> </span><span class="n">coref</span>::<span class="n">xml</span>::<span class="p">{</span><span class="n">XmlDB</span><span class="p">,</span><span class="w"> </span><span class="n">XmlElement</span><span class="p">}</span><span class="w"> </span><span class="c1">// Import multiple symbols
</span></span></span></code></pre></div><h4 id="module-import-rules">Module Import Rules</h4>
<p>The GödelScript package manager is enabled when the input parameters include <code>-p {package dir path}</code>.</p>
<p>The package manager will parse the folder structure, traversing all <code>.gdl</code> files. After obtaining the relative path of the files, it will map the path to the corresponding package path. If the relative path contains <code>-</code>, or if a folder name or filename starts with a digit, the path will not be accepted by the package manager, but it will not issue an error and will simply ignore it.</p>
<p>If you want to know which paths were ignored, you can use the <code>-v</code> parameter. With this parameter, the package manager will report the ignored paths as <code>warnings</code>. If there are path conflicts in the mapped paths, the package manager will report them as <code>errors</code> and exit the compilation process.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="n">packages</span>:
</span></span><span class="line"><span class="cl">  <span class="nc">coref</span>::<span class="n">cfamily</span><span class="w">    </span>-&gt; <span class="o">/..</span><span class="p">.</span><span class="o">/</span><span class="n">Library</span><span class="o">/</span><span class="n">coref</span><span class="p">.</span><span class="n">cfamily</span><span class="p">.</span><span class="n">gdl</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">coref</span>::<span class="n">go</span><span class="w">         </span>-&gt; <span class="o">/..</span><span class="p">.</span><span class="o">/</span><span class="n">Library</span><span class="o">/</span><span class="n">coref</span><span class="p">.</span><span class="n">go</span><span class="p">.</span><span class="n">gdl</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">coref</span>::<span class="n">java</span><span class="w">       </span>-&gt; <span class="o">/..</span><span class="p">.</span><span class="o">/</span><span class="n">Library</span><span class="o">/</span><span class="n">coref</span><span class="p">.</span><span class="n">java</span><span class="p">.</span><span class="n">gdl</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">coref</span>::<span class="n">javascript</span><span class="w"> </span>-&gt; <span class="o">/..</span><span class="p">.</span><span class="o">/</span><span class="n">Library</span><span class="o">/</span><span class="n">coref</span><span class="p">.</span><span class="n">javascript</span><span class="p">.</span><span class="n">gdl</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">coref</span>::<span class="n">properties</span><span class="w"> </span>-&gt; <span class="o">/..</span><span class="p">.</span><span class="o">/</span><span class="n">Library</span><span class="o">/</span><span class="n">coref</span><span class="p">.</span><span class="n">properties</span><span class="p">.</span><span class="n">gdl</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">coref</span>::<span class="n">python</span><span class="w">     </span>-&gt; <span class="o">/..</span><span class="p">.</span><span class="o">/</span><span class="n">Library</span><span class="o">/</span><span class="n">coref</span><span class="p">.</span><span class="n">python</span><span class="p">.</span><span class="n">gdl</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">coref</span>::<span class="n">sql</span><span class="w">        </span>-&gt; <span class="o">/..</span><span class="p">.</span><span class="o">/</span><span class="n">Library</span><span class="o">/</span><span class="n">coref</span><span class="p">.</span><span class="n">sql</span><span class="p">.</span><span class="n">gdl</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">coref</span>::<span class="n">xml</span><span class="w">        </span>-&gt; <span class="o">/..</span><span class="p">.</span><span class="o">/</span><span class="n">Library</span><span class="o">/</span><span class="n">coref</span><span class="p">.</span><span class="n">xml</span><span class="p">.</span><span class="n">gdl</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">modules</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="o">+--</span><span class="n">coref</span><span class="w"> </span>-&gt; <span class="nc">coref</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="o">|--</span><span class="n">xml</span><span class="w"> </span>-&gt; <span class="nc">coref</span>::<span class="n">xml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="o">|--</span><span class="n">properties</span><span class="w"> </span>-&gt; <span class="nc">coref</span>::<span class="n">properties</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="o">|--</span><span class="n">cfamily</span><span class="w"> </span>-&gt; <span class="nc">coref</span>::<span class="n">cfamily</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="o">|--</span><span class="n">java</span><span class="w"> </span>-&gt; <span class="nc">coref</span>::<span class="n">java</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="o">|--</span><span class="n">javascript</span><span class="w"> </span>-&gt; <span class="nc">coref</span>::<span class="n">javascript</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="o">|--</span><span class="n">go</span><span class="w"> </span>-&gt; <span class="nc">coref</span>::<span class="n">go</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="o">|--</span><span class="n">sql</span><span class="w"> </span>-&gt; <span class="nc">coref</span>::<span class="n">sql</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="o">+--</span><span class="n">python</span><span class="w"> </span>-&gt; <span class="nc">coref</span>::<span class="n">python</span><span class="w">
</span></span></span></code></pre></div><h4 id="path-mapping-example">Path Mapping Example</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="n">Library</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|--</span><span class="w"> </span><span class="n">coref</span><span class="p">.</span><span class="n">java</span><span class="p">.</span><span class="n">gdl</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|--</span><span class="w"> </span><span class="n">coref</span><span class="p">.</span><span class="n">xml</span><span class="p">.</span><span class="n">gdl</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+--</span><span class="w"> </span><span class="n">coref</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">|--</span><span class="w"> </span><span class="n">go</span><span class="p">.</span><span class="n">gdl</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">+--</span><span class="w"> </span><span class="n">a</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="o">+--</span><span class="w"> </span><span class="n">b</span><span class="p">.</span><span class="n">gdl</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">=&gt;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">coref</span>::<span class="n">java</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">coref</span>::<span class="n">xml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">coref</span>::<span class="n">go</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">coref</span>::<span class="n">a</span>::<span class="n">b</span><span class="w">
</span></span></span></code></pre></div><p>In this example, there is a path conflict:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="n">Library</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|--</span><span class="w"> </span><span class="n">coref</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">   </span><span class="o">|--</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="n">gdl</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">   </span><span class="o">+--</span><span class="w"> </span><span class="n">python</span><span class="p">.</span><span class="n">gdl</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+--</span><span class="w"> </span><span class="n">coref</span><span class="p">.</span><span class="n">python</span><span class="p">.</span><span class="n">gdl</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">=&gt;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">coref</span>::<span class="n">java</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">coref</span>::<span class="n">python</span><span class="w"> </span><span class="o">--</span><span class="w"> </span><span class="err">\</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                  </span><span class="o">&gt;</span><span class="w"> </span><span class="n">Conflict</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">coref</span>::<span class="n">python</span><span class="w"> </span><span class="o">--</span><span class="w"> </span><span class="o">/</span><span class="w">
</span></span></span></code></pre></div><p>In this example, there are invalid characters in the path:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="n">Library</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|--</span><span class="w"> </span><span class="mf">0123.</span><span class="n">gdl</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|--</span><span class="w"> </span><span class="n">my</span><span class="o">-</span><span class="n">godel</span><span class="o">-</span><span class="n">lib</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w">   </span><span class="o">+--</span><span class="w"> </span><span class="n">js</span><span class="p">.</span><span class="n">gdl</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+--</span><span class="w"> </span><span class="n">lib</span><span class="o">-</span><span class="n">file</span><span class="p">.</span><span class="mf">123.</span><span class="n">gdl</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">=&gt;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="mi">0123</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">^</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">character</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">digit</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">my</span><span class="o">-</span><span class="n">godel</span><span class="o">-</span><span class="n">lib</span>::<span class="n">js</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="o">^</span><span class="w">     </span><span class="o">^</span><span class="w"> </span><span class="n">Uses</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="err">`</span><span class="o">-</span><span class="err">`</span><span class="w"> </span><span class="n">character</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">lib</span><span class="o">-</span><span class="n">file</span>::<span class="mi">123</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="o">^</span><span class="w">      </span><span class="o">^</span><span class="w"> </span><span class="n">First</span><span class="w"> </span><span class="n">character</span><span class="w"> </span><span class="n">after</span><span class="w"> </span><span class="err">`</span><span class="p">.</span><span class="err">`</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">digit</span><span class="p">,</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="n">contains</span><span class="w"> </span><span class="err">`</span><span class="o">-</span><span class="err">`</span><span class="w">
</span></span></span></code></pre></div><h4 id="symbol-conflict">Symbol Conflict</h4>
<p>In use, it&rsquo;s possible to encounter situations with symbol conflicts. In such cases, direct use of <code>File</code> will result in a symbol conflict, and you need to specify one of the symbols.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">use</span><span class="w"> </span><span class="n">coref</span>::<span class="n">java</span>::<span class="n">Location</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">use</span><span class="w"> </span><span class="n">coref</span>::<span class="n">xml</span>::<span class="n">Location</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">schema</span><span class="w"> </span><span class="n">MyLoc</span><span class="w"> </span><span class="n">extends</span><span class="w"> </span><span class="n">Location</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                     </span><span class="o">^^^^^^^^</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Error</span>: <span class="s">&#34;Location&#34;</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">ambiguous</span><span class="p">,</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="n">symbols</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="s">&#34;coref::java::Location, coref::xml::Location&#34;</span><span class="p">.</span><span class="w">
</span></span></span></code></pre></div><p>Like other languages, GödelScript allows specifying a symbol directly through its full path, provided the symbol has been imported.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">use</span><span class="w"> </span><span class="n">coref</span>::<span class="n">java</span>::<span class="n">Location</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">use</span><span class="w"> </span><span class="n">coref</span>::<span class="n">xml</span>::<span class="n">Location</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">schema</span><span class="w"> </span><span class="n">MyLoc</span><span class="w"> </span><span class="n">extends</span><span class="w"> </span><span class="n">coref</span>::<span class="n">xml</span>::<span class="n">Location</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span></span></span></code></pre></div><p>Full path symbols can be used in the following situations:</p>
<ul>
<li>Schema inheritance</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="n">schema</span><span class="w"> </span><span class="n">JavaLocation</span><span class="w"> </span><span class="n">extends</span><span class="w"> </span><span class="n">coref</span>::<span class="n">java</span>::<span class="n">Location</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span></span></span></code></pre></div><ul>
<li>Function parameters and return values</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">fn</span> <span class="nf">return_java_file</span><span class="p">(</span><span class="n">f</span>: <span class="nc">coref</span>::<span class="n">java</span>::<span class="n">File</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">coref</span>::<span class="n">java</span>::<span class="n">File</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">..</span><span class="p">.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><ul>
<li>Database declarations</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="n">database</span><span class="w"> </span><span class="n">MyDB</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">java_file</span>: <span class="nc">coref</span>::<span class="n">java</span>::<span class="n">File</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">xml_file</span>: <span class="nc">coref</span>::<span class="n">xml</span>::<span class="n">File</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">java_loc</span>: <span class="nc">coref</span>::<span class="n">java</span>::<span class="n">Location</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">xml_loc</span>: <span class="nc">coref</span>::<span class="n">xml</span>::<span class="n">Location</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><ul>
<li>Query list type declarations</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="n">query</span><span class="w"> </span><span class="n">example</span><span class="w"> </span><span class="n">from</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">coref</span>::<span class="n">java</span>::<span class="n">Location</span><span class="w"> </span><span class="n">loc</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">coref</span>::<span class="n">java</span>::<span class="n">Location</span><span class="p">(</span><span class="n">coref</span>::<span class="n">java</span>::<span class="n">JavaDB</span>::<span class="n">load</span><span class="p">(</span><span class="s">&#34;...&#34;</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="o">..</span><span class="p">.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">select</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="o">..</span><span class="p">.</span><span class="w">
</span></span></span></code></pre></div><ul>
<li>Schema static method calls</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">for</span><span class="p">(</span><span class="n">loc</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">coref</span>::<span class="n">java</span>::<span class="n">Location</span><span class="p">(</span><span class="n">coref</span>::<span class="n">java</span>::<span class="n">JavaDB</span>::<span class="n">load</span><span class="p">(</span><span class="s">&#34;...&#34;</span><span class="p">)))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">..</span><span class="p">.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">stmt</span><span class="p">.</span><span class="n">to</span><span class="o">&lt;</span><span class="n">coref</span>::<span class="n">java</span>::<span class="n">ElementParent</span><span class="o">&gt;</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">stmt</span><span class="p">.</span><span class="n">is</span><span class="o">&lt;</span><span class="n">coref</span>::<span class="n">java</span>::<span class="n">ElementParent</span><span class="o">&gt;</span><span class="p">()</span><span class="w">
</span></span></span></code></pre></div><h3 id="query">Query</h3>
<p>Query is used for simple queries and is guaranteed to be output even without declaring a <code>main</code> function. The syntax format for query is as follows:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="n">query</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">from</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">variable</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">initial</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">variable</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">initial</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">variable</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">initial</span><span class="w"> </span><span class="n">value</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">condition</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">select</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="n">column</span><span class="w"> </span><span class="n">name</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">value</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="n">column</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">value</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="n">column</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">value</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="n">column</span><span class="w"> </span><span class="n">name</span><span class="w">
</span></span></span></code></pre></div><p>Variable declarations in the <code>from</code> list do not need type annotations, as the compiler will automatically infer them. Additionally, the <code>select</code> list does not use <code>=</code> but the <code>in</code> keyword. Also, in the <code>select</code> list, the output column name cannot conflict with the calculation variables, but the column name can be omitted. Omitted column names will take random names in the output results, so it&rsquo;s best not to omit them.</p>
<p>Here is a <code>hello world</code> written in query syntax:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="n">query</span><span class="w"> </span><span class="n">hello_world</span><span class="w"> </span><span class="n">from</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">info</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s">&#34;hello world&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">select</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">greeting</span><span class="w">
</span></span></span></code></pre></div><p>The code above is equivalent to the following code:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">fn</span> <span class="nf">hello_world</span><span class="p">(</span><span class="n">greeting</span>: <span class="nc">string</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;hello world&#34;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">greeting</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">info</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">output</span><span class="p">(</span><span class="n">hello_world</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h4 id="example-and-composition-structure">Example and Composition Structure</h4>
<p>Query includes a query name, a <code>from</code> list, a <code>where</code> filter condition, and a <code>select</code> list.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="c1">// script
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">use</span><span class="w"> </span><span class="n">coref</span>::<span class="n">java</span>::<span class="p">{</span><span class="n">Callable</span><span class="p">,</span><span class="w"> </span><span class="n">Class</span><span class="p">,</span><span class="w"> </span><span class="n">Interface</span><span class="p">,</span><span class="w"> </span><span class="n">JavaDB</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">db</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">JavaDB</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">JavaDB</span>::<span class="n">load</span><span class="p">(</span><span class="s">&#34;coref_java_src.db&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">query</span><span class="w"> </span><span class="n">class_method</span><span class="w"> </span><span class="n">from</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">Callable</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Callable</span><span class="p">(</span><span class="n">db</span><span class="p">()),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">Class</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Class</span><span class="p">(</span><span class="n">db</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">c</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">getBelongedClass</span><span class="p">().</span><span class="n">id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">select</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">c</span><span class="p">.</span><span class="n">getQualifiedName</span><span class="p">()</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">className</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">m</span><span class="p">.</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">methodName</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">m</span><span class="p">.</span><span class="n">getSignature</span><span class="p">()</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">methodSignature</span><span class="w">
</span></span></span></code></pre></div><h4 id="equivalent-code">Equivalent Code</h4>
<p>The example above is equivalent to the following code:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="c1">// script
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">use</span><span class="w"> </span><span class="n">coref</span>::<span class="n">java</span>::<span class="p">{</span><span class="n">Callable</span><span class="p">,</span><span class="w"> </span><span class="n">Class</span><span class="p">,</span><span class="w"> </span><span class="n">Interface</span><span class="p">,</span><span class="w"> </span><span class="n">JavaDB</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">db</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">JavaDB</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">JavaDB</span>::<span class="n">load</span><span class="p">(</span><span class="s">&#34;coref_java_src.db&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">output</span><span class="p">(</span><span class="n">class_method</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">class_method</span><span class="p">(</span><span class="n">className</span>: <span class="nc">string</span><span class="p">,</span><span class="w"> </span><span class="n">methodName</span>: <span class="nc">string</span><span class="p">,</span><span class="w"> </span><span class="n">methodSignature</span>: <span class="nc">string</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Callable</span><span class="p">(</span><span class="n">db</span><span class="p">()),</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Class</span><span class="p">(</span><span class="n">db</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">getBelongedClass</span><span class="p">().</span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">className</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="p">.</span><span class="n">getQualifiedName</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="n">methodName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="n">methodSignature</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">getSignature</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h3 id="ungrounded-error">Ungrounded Error</h3>
<p>GödelScript will determine symbols that are not bound to a set as <code>ungrounded</code>. The basic rule of judgment is:</p>
<ul>
<li>Uninitialized/unusued/unbound symbols
<ul>
<li>Unbound <code>int</code>, <code>string</code> arguments</li>
<li>Unused database type arguments</li>
<li>Function body has statements, but no return statements</li>
</ul>
</li>
<li>Symbols bound within negation blocks
<ul>
<li>For example, <code>!(__tmp = 1)</code>, <code>__tmp</code> is considered unbound</li>
<li>Calling inline functions or data constructors in negation blocks</li>
</ul>
</li>
</ul>
<h4 id="1-unused-databasebasic-type-parameters">1. Unused Database/Basic Type Parameters</h4>
<p>In the function block, if there is a branch that does not use database or basic type parameters, it will inevitably lead to <code>ungrounded</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">fn</span> <span class="nf">test</span><span class="p">(</span><span class="n">db</span>: <span class="nc">JavaDB</span><span class="p">,</span><span class="w"> </span><span class="n">a</span>: <span class="nc">int</span><span class="p">,</span><span class="w"> </span><span class="n">b</span>: <span class="nc">string</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="o">^^</span><span class="w">          </span><span class="o">^</span><span class="w">       </span><span class="o">^</span><span class="w">                  </span><span class="o">^^</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Error</span>: <span class="nc">ungrounded</span><span class="w"> </span><span class="n">parameter</span><span class="w"> </span><span class="s">&#34;db, a, b&#34;</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">branch</span><span class="p">.</span><span class="w">
</span></span></span></code></pre></div><p>The compiler will indicate in which branch there is an unused parameter. Check the corresponding execution path and complete the parameter constraints based on the prompt.</p>
<p>If some functions have basic type parameters but always use literals when called, and if <code>ungrounded</code> is incorrectly reported, you can add an <code>@inline</code> annotation to the function to avoid incorrect constraint checks.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">impl</span><span class="w"> </span><span class="no">XXX</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">@</span><span class="n">inline</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">getValueByAttributeNameByDefaultValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">attributeName</span>: <span class="nc">string</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">string</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">hasAttribute</span><span class="p">(</span><span class="n">attributeName</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">getValueByAttributeName</span><span class="p">(</span><span class="n">attributeName</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="bp">self</span><span class="p">.</span><span class="n">hasAttribute</span><span class="p">(</span><span class="n">attributeName</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="s">&#34;null&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">xxx</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">xx</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">..</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">attr</span><span class="p">.</span><span class="n">getValueByAttributeNameByDefaultValue</span><span class="p">(</span><span class="s">&#34;pattern&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                                               </span><span class="o">^^^^^^^^^</span><span class="w"> </span><span class="n">Use</span><span class="w"> </span><span class="n">literals</span><span class="p">,</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="o">@</span><span class="n">inline</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">pass</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">check</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h4 id="2-no-return-statement-in-non-empty-function-body">2. No Return Statement in Non-Empty Function Body</h4>
<p>GödelScript allows an empty function body without any statements. However, if there are other statements in the function body, GödelScript requires at least one return statement, otherwise an <code>ungrounded</code> error will occur.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">fn</span> <span class="nf">test</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">int</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                  </span><span class="o">^^</span><span class="w"> </span><span class="n">No</span><span class="w"> </span><span class="n">statements</span><span class="p">,</span><span class="w"> </span><span class="n">passes</span><span class="w"> </span><span class="n">compilation</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">test</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">int</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">^^^^^^^^^^^^^^</span><span class="w"> </span><span class="n">Statements</span><span class="w"> </span><span class="n">present</span><span class="p">,</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">statement</span><span class="p">,</span><span class="w"> </span><span class="n">ungrounded</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h4 id="3-using-inline-functions-or-data-constructors-in-negation-blocks">3. Using Inline Functions or Data Constructors in Negation Blocks</h4>
<p>As mentioned above, <code>@inline</code> annotation can be used to circumvent <code>ungrounded</code> errors. However, if inline functions are used in negation blocks, it will inevitably result in <code>ungrounded</code> errors.</p>
<p>Similarly, data constructors are used to bind temporary intermediate variables, but this will directly result in <code>ungrounded</code> errors.
Therefore, using inline functions or data constructors in negation blocks will inevitably lead to <code>ungrounded</code> errors, and the compiler will report errors for all such cases.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">check</span><span class="p">(</span><span class="n">method</span><span class="p">.</span><span class="n">to</span><span class="o">&lt;</span><span class="n">ElementParent</span><span class="o">&gt;</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">           </span><span class="o">^^^^^^^^^^^^^^^^^^^^^^^^^^</span><span class="w"> </span><span class="n">ungrounded</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">check</span><span class="p">(</span><span class="n">ElementParent</span><span class="w"> </span><span class="p">{</span><span class="n">id</span>: <span class="mi">0</span><span class="p">}))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">           </span><span class="o">^^^^^^^^^^^^^^</span><span class="w"> </span><span class="n">ungrounded</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">@</span><span class="n">inline</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">for_test</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">ElementParent</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">..</span><span class="p">.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">check</span><span class="p">(</span><span class="n">for_test</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">           </span><span class="o">^^^^^^^^^^</span><span class="w"> </span><span class="n">Negation</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">contains</span><span class="w"> </span><span class="n">inline</span><span class="w"> </span><span class="n">function</span><span class="p">,</span><span class="w"> </span><span class="n">ungrounded</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h4 id="4-negation-of-chained-calls">4. Negation of Chained Calls</h4>
<p>GödelScript does not perform <code>ungrounded</code> checks for negation of chained calls, but this writing will cause an <code>ungrounded</code> error in Soufflé:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">use</span><span class="w"> </span><span class="n">coref</span>::<span class="n">java</span>::<span class="o">*</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">default_java_db</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">JavaDB</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">JavaDB</span>::<span class="n">load</span><span class="p">(</span><span class="s">&#34;coref_java_src.db&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">get_field</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="o">*</span><span class="n">Field</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">field</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Field</span><span class="p">(</span><span class="n">default_java_db</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">field</span><span class="p">.</span><span class="n">getLocation</span><span class="p">().</span><span class="n">getFile</span><span class="p">().</span><span class="n">getRelativePath</span><span class="p">().</span><span class="n">contains</span><span class="p">(</span><span class="s">&#34;/test/&#34;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="kr">yield</span><span class="w"> </span><span class="n">field</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>Where:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="o">!</span><span class="n">field</span><span class="p">.</span><span class="n">getLocation</span><span class="p">().</span><span class="n">getFile</span><span class="p">().</span><span class="n">getRelativePath</span><span class="p">().</span><span class="n">contains</span><span class="p">(</span><span class="s">&#34;/test/&#34;</span><span class="p">)</span><span class="w">
</span></span></span></code></pre></div><p>It will be translated to a Soufflé code fragment like this:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="o">!</span><span class="p">(</span><span class="n">__tmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">field</span><span class="p">,</span><span class="w"> </span><span class="n">Field_getLocation</span><span class="p">(</span><span class="n">__tmp</span><span class="p">,</span><span class="w"> </span><span class="n">__tmp_1</span><span class="p">),</span><span class="w"> </span><span class="o">..</span><span class="p">.,</span><span class="w"> </span><span class="n">contains</span><span class="p">(</span><span class="s">&#34;/test/&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">__tmp_4</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="o">^^^^^</span><span class="w">                                   </span><span class="o">^^^^^^^</span><span class="w">
</span></span></span></code></pre></div><p>The variables used for intermediate storage being bound in <code>!(...)</code> but due to the negation operator, this binding is considered hypothetical. However, <code>__tmp</code>, <code>__tmp_1</code> are then considered to be variables declared for the entire statement scope, leading to <code>ungrounded</code>.</p>
<p>This can be avoided by declaring intermediate variables to catch intermediate results in a negation operation:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">fn</span> <span class="nf">get_field</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="o">*</span><span class="n">Field</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">field</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Field</span><span class="p">(</span><span class="n">default_java_db</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">field</span><span class="p">.</span><span class="n">getLocation</span><span class="p">().</span><span class="n">getFile</span><span class="p">().</span><span class="n">getRelativePath</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">path</span><span class="p">.</span><span class="n">contains</span><span class="p">(</span><span class="s">&#34;/test/&#34;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="kr">yield</span><span class="w"> </span><span class="n">field</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h2 id="query-examples">Query Examples</h2>
<h3 id="java">Java</h3>
<h4 id="unused-methods">Unused Methods</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="c1">// script
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">use</span><span class="w"> </span><span class="n">coref</span>::<span class="n">java</span>::<span class="o">*</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">default_java_db</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">JavaDB</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">JavaDB</span>::<span class="n">load</span><span class="p">(</span><span class="s">&#34;coref_java_src.db&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// find unused methods
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">fn</span> <span class="nf">unused_method</span><span class="p">(</span><span class="n">unused</span>: <span class="nc">string</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">c</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Callable</span><span class="p">(</span><span class="n">default_java_db</span><span class="p">()),</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Callable</span><span class="p">(</span><span class="n">default_java_db</span><span class="p">()),</span><span class="w"> </span><span class="n">caller</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">method</span><span class="p">.</span><span class="n">getCaller</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">caller</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">unused</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">method</span><span class="p">.</span><span class="n">getSignature</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">output</span><span class="p">(</span><span class="n">unused_method</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h4 id="class-inheritance-relationship">Class Inheritance Relationship</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="c1">// script
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">use</span><span class="w"> </span><span class="n">coref</span>::<span class="n">java</span>::<span class="o">*</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">default_java_db</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">JavaDB</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">JavaDB</span>::<span class="n">load</span><span class="p">(</span><span class="s">&#34;coref_java_src.db&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="sd">/**
</span></span></span><span class="line"><span class="cl"><span class="sd"> * Find all class and the inheritances
</span></span></span><span class="line"><span class="cl"><span class="sd"> * including parent class inheritance and ancestor class inheritance
</span></span></span><span class="line"><span class="cl"><span class="sd"> */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">class_hierarchy</span><span class="p">(</span><span class="n">className</span><span class="w"> </span>: <span class="nc">string</span><span class="p">,</span><span class="w"> </span><span class="n">superClassName</span><span class="w"> </span>: <span class="nc">string</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Class</span><span class="p">(</span><span class="n">default_java_db</span><span class="p">()),</span><span class="w"> </span><span class="n">ancestor</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">c</span><span class="p">.</span><span class="n">getAnAncestorClass</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">className</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="p">.</span><span class="n">getQualifiedName</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">superClassName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ancestor</span><span class="p">.</span><span class="n">getQualifiedName</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">output</span><span class="p">(</span><span class="n">class_hierarchy</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h4 id="querying-all-methods-in-a-class">Querying All Methods in a Class</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="c1">// script
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">use</span><span class="w"> </span><span class="n">coref</span>::<span class="n">java</span>::<span class="o">*</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">default_java_db</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">JavaDB</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">JavaDB</span>::<span class="n">load</span><span class="p">(</span><span class="s">&#34;coref_java_src.db&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// Find all methods of the class
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">fn</span> <span class="nf">methods</span><span class="p">(</span><span class="n">className</span><span class="w"> </span>: <span class="nc">string</span><span class="p">,</span><span class="w"> </span><span class="n">methodName</span><span class="w"> </span>: <span class="nc">string</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Class</span><span class="p">(</span><span class="n">default_java_db</span><span class="p">()),</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">c</span><span class="p">.</span><span class="n">getAllMethods</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">className</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="p">.</span><span class="n">getQualifiedName</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">methodName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">getName</span><span class="p">()){</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">output</span><span class="p">(</span><span class="n">methods</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h3 id="python">Python</h3>
<h4 id="cyclomatic-complexity">Cyclomatic Complexity</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="c1">// script
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">use</span><span class="w"> </span><span class="n">coref</span>::<span class="n">python</span>::<span class="o">*</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">default_db</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">PythonDB</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">PythonDB</span>::<span class="n">load</span><span class="p">(</span><span class="s">&#34;coref_python_src.db&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="sd">/**
</span></span></span><span class="line"><span class="cl"><span class="sd"> * Get cyclomatic complexity of functions
</span></span></span><span class="line"><span class="cl"><span class="sd"> *
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param name   function name
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param value  cyclomatic complexity of function
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param path   path of file including this function
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param sline  function start line
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param eline  function end line
</span></span></span><span class="line"><span class="cl"><span class="sd"> */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">getCyclomaticComplexity</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">name</span>: <span class="nc">string</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">value</span>: <span class="nc">int</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">path</span>: <span class="nc">string</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">sline</span>: <span class="nc">int</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">eline</span>: <span class="nc">int</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// get metric function
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">MetricFunction</span><span class="p">(</span><span class="n">default_db</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="p">.</span><span class="n">getLocation</span><span class="p">().</span><span class="n">getFile</span><span class="p">().</span><span class="n">getRelativePath</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="p">.</span><span class="n">getQualifiedName</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="p">.</span><span class="n">getCyclomaticComplexity</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">sline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="p">.</span><span class="n">getLocation</span><span class="p">().</span><span class="n">getStartLineNumber</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">eline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="p">.</span><span class="n">getLocation</span><span class="p">().</span><span class="n">getEndLineNumber</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">output</span><span class="p">(</span><span class="n">getCyclomaticComplexity</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h4 id="comment-rate">Comment Rate</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="c1">// script
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">use</span><span class="w"> </span><span class="n">coref</span>::<span class="n">python</span>::<span class="o">*</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">schema</span><span class="w"> </span><span class="n">PublicVisitedElement</span><span class="w"> </span><span class="n">extends</span><span class="w"> </span><span class="n">CombineElement</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">impl</span><span class="w"> </span><span class="n">PublicVisitedElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">@</span><span class="n">data_constraint</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span> <span class="nf">__all__</span><span class="p">(</span><span class="n">db</span>: <span class="nc">PythonDB</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="o">*</span><span class="n">PublicVisitedElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">tmp</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Class</span><span class="p">(</span><span class="n">db</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="kr">yield</span><span class="w"> </span><span class="n">PublicVisitedElement</span><span class="w"> </span><span class="p">{</span><span class="n">id</span>: <span class="nc">tmp</span><span class="p">.</span><span class="n">element_oid</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">tmp</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Function</span><span class="p">(</span><span class="n">db</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="kr">yield</span><span class="w"> </span><span class="n">PublicVisitedElement</span><span class="w"> </span><span class="p">{</span><span class="n">id</span>: <span class="nc">tmp</span><span class="p">.</span><span class="n">element_oid</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">default_db</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">PythonDB</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">PythonDB</span>::<span class="n">load</span><span class="p">(</span><span class="s">&#34;coref_python_src.db&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// count number of total public element
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">fn</span> <span class="nf">countTotalPublicElement</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">int</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">PublicVisitedElement</span><span class="p">(</span><span class="n">default_db</span><span class="p">()).</span><span class="n">len</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// get public elements with Docstring comment
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">fn</span> <span class="nf">withDocstringCommentElement</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="o">*</span><span class="n">PublicVisitedElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">db</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">default_db</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">PublicVisitedElement</span><span class="p">(</span><span class="n">db</span><span class="p">),</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">DocstringComment</span><span class="p">(</span><span class="n">db</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">key_eq</span><span class="p">(</span><span class="n">j</span><span class="p">.</span><span class="n">getDocumentableElement</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="kr">yield</span><span class="w"> </span><span class="n">e</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// count number of public elements with Docstring comment
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">fn</span> <span class="nf">countTotalPublicDocumentedElement</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">int</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">withDocstringCommentElement</span><span class="p">().</span><span class="n">len</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">withPublicDocumentedBelowElement</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="o">*</span><span class="n">PublicVisitedElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">db</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">default_db</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">PublicVisitedElement</span><span class="p">(</span><span class="n">db</span><span class="p">),</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Comment</span><span class="p">(</span><span class="n">db</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">key_eq</span><span class="p">(</span><span class="n">j</span><span class="p">.</span><span class="n">getDocumentedClassOrFunctionElement</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="kr">yield</span><span class="w"> </span><span class="n">e</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// count number of public element with single line comment
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">fn</span> <span class="nf">countTotalPublicDocumentedBelowElement</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">int</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">withPublicDocumentedBelowElement</span><span class="p">().</span><span class="n">len</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// calculate documented percentage
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">fn</span> <span class="nf">getDocumentedPercentage</span><span class="p">(</span><span class="n">documentedPercentage</span>: <span class="nc">int</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">countTotalPublicElement</span><span class="p">(),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">countTotalPublicDocumentedElement</span><span class="p">(),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">countTotalPublicDocumentedBelowElement</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">documentedPercentage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">documentedPercentage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1000</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">output</span><span class="p">(</span><span class="n">getDocumentedPercentage</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h4 id="comments-in-a-method">Comments in a Method</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="c1">// script
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">use</span><span class="w"> </span><span class="n">coref</span>::<span class="n">python</span>::<span class="o">*</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">schema</span><span class="w"> </span><span class="n">PublicVisitedElement</span><span class="w"> </span><span class="n">extends</span><span class="w"> </span><span class="n">CombineElement</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">impl</span><span class="w"> </span><span class="n">PublicVisitedElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">@</span><span class="n">data_constraint</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span> <span class="nf">__all__</span><span class="p">(</span><span class="n">db</span>: <span class="nc">PythonDB</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="o">*</span><span class="n">PublicVisitedElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">tmp</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Class</span><span class="p">(</span><span class="n">db</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="kr">yield</span><span class="w"> </span><span class="n">PublicVisitedElement</span><span class="w"> </span><span class="p">{</span><span class="n">id</span>: <span class="nc">tmp</span><span class="p">.</span><span class="n">element_oid</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">tmp</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Function</span><span class="p">(</span><span class="n">db</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="kr">yield</span><span class="w"> </span><span class="n">PublicVisitedElement</span><span class="w"> </span><span class="p">{</span><span class="n">id</span>: <span class="nc">tmp</span><span class="p">.</span><span class="n">element_oid</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span> <span class="nf">getName</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">string</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">tmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Class</span><span class="p">(</span><span class="n">__all_data__</span><span class="p">).</span><span class="n">find</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">tmp</span><span class="p">.</span><span class="n">getQualifiedName</span><span class="p">()</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">tmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Function</span><span class="p">(</span><span class="n">__all_data__</span><span class="p">).</span><span class="n">find</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">tmp</span><span class="p">.</span><span class="n">getQualifiedName</span><span class="p">()</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">default_db</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">PythonDB</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">PythonDB</span>::<span class="n">load</span><span class="p">(</span><span class="s">&#34;coref_python_src.db&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">hasComment</span><span class="p">(</span><span class="n">e</span>: <span class="nc">PublicVisitedElement</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">db</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">default_db</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">DocstringComment</span><span class="p">(</span><span class="n">db</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">key_eq</span><span class="p">(</span><span class="n">j</span><span class="p">.</span><span class="n">getDocumentableElement</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Comment</span><span class="p">(</span><span class="n">db</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">key_eq</span><span class="p">(</span><span class="n">j</span><span class="p">.</span><span class="n">getDocumentedClassOrFunctionElement</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="sd">/**
</span></span></span><span class="line"><span class="cl"><span class="sd"> * Get comment of each public element
</span></span></span><span class="line"><span class="cl"><span class="sd"> *
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param type          public visited element type
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param name          public visited element name
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param filePath      file path
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param sline         element start line
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param eline         element end line
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param isCommented   if is commented
</span></span></span><span class="line"><span class="cl"><span class="sd"> */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">output_result</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">type</span>: <span class="nc">string</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">name</span>: <span class="nc">string</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">filePath</span>: <span class="nc">string</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">sline</span>: <span class="nc">int</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">eline</span>: <span class="nc">int</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">isCommented</span>: <span class="nc">int</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">PublicVisitedElement</span><span class="p">(</span><span class="n">default_db</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">type</span> <span class="o">=</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">getType</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">filePath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">getLocation</span><span class="p">().</span><span class="n">getFile</span><span class="p">().</span><span class="n">getRelativePath</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">sline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">getLocation</span><span class="p">().</span><span class="n">getStartLineNumber</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">eline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">getLocation</span><span class="p">().</span><span class="n">getEndLineNumber</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">hasComment</span><span class="p">(</span><span class="n">e</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isCommented</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">hasComment</span><span class="p">(</span><span class="n">e</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isCommented</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">output</span><span class="p">(</span><span class="n">output_result</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h3 id="javascript">JavaScript</h3>
<h4 id="ast-print">AST Print</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="c1">// script
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">use</span><span class="w"> </span><span class="n">coref</span>::<span class="n">javascript</span>::<span class="o">*</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="sd">/**
</span></span></span><span class="line"><span class="cl"><span class="sd"> * print AST
</span></span></span><span class="line"><span class="cl"><span class="sd"> *
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param filePath          file path
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param parentId          parent node ID
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param parentKind        parent node kind
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param parentStartLine   parent node start line
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param parentEndLine     parent node end line
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param childId           child node ID
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param childKind         child node kind
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param childStartLine    child node start line
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param childEndLine      child node end line
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param index             child node index
</span></span></span><span class="line"><span class="cl"><span class="sd"> */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">out</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">filePath</span>: <span class="nc">string</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">parentId</span>: <span class="nc">int</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">parentKind</span>: <span class="nc">string</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">parentStartLine</span>: <span class="nc">int</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">parentEndLine</span>: <span class="nc">int</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">childId</span>: <span class="nc">int</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">childKind</span>: <span class="nc">string</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">childStartLine</span>: <span class="nc">int</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">childEndLine</span>: <span class="nc">int</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">index</span>: <span class="nc">int</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">db</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">JavascriptDB</span>::<span class="n">load</span><span class="p">(</span><span class="s">&#34;coref_javascript_src.db&#34;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">parent</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Node</span><span class="p">(</span><span class="n">db</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">child</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Node</span><span class="p">(</span><span class="n">db</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">parentSyntaxKind</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">SyntaxKind</span><span class="p">(),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">childSyntaxKind</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">SyntaxKind</span><span class="p">(),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">parentLocation</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Location</span><span class="p">(</span><span class="n">db</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">childLocation</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Location</span><span class="p">(</span><span class="n">db</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">file</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">File</span><span class="p">(</span><span class="n">db</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">parent</span><span class="p">.</span><span class="n">key_eq</span><span class="p">(</span><span class="n">child</span><span class="p">.</span><span class="n">getParent</span><span class="p">())</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">parentId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parent</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">childId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">child</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">parentSyntaxKind</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parent</span><span class="p">.</span><span class="n">getKind</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">childSyntaxKind</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">child</span><span class="p">.</span><span class="n">getKind</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">parentKind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parentSyntaxKind</span><span class="p">.</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">childKind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">childSyntaxKind</span><span class="p">.</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">child</span><span class="p">.</span><span class="n">getIndex</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">parentLocation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parent</span><span class="p">.</span><span class="n">getLocation</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">childLocation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parent</span><span class="p">.</span><span class="n">getLocation</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parentLocation</span><span class="p">.</span><span class="n">getFile</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">filePath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">file</span><span class="p">.</span><span class="n">getRelativePath</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">parentStartLine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parentLocation</span><span class="p">.</span><span class="n">getStartLineNumber</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">parentEndLine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parentLocation</span><span class="p">.</span><span class="n">getEndLineNumber</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">childStartLine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">childLocation</span><span class="p">.</span><span class="n">getStartLineNumber</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">childEndLine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">childLocation</span><span class="p">.</span><span class="n">getEndLineNumber</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">output</span><span class="p">(</span><span class="n">out</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h4 id="cyclomatic-complexity-1">Cyclomatic complexity</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="c1">// script
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">use</span><span class="w"> </span><span class="n">coref</span>::<span class="n">javascript</span>::<span class="o">*</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">default_db</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">JavascriptDB</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">JavascriptDB</span>::<span class="n">load</span><span class="p">(</span><span class="s">&#34;coref_javascript_src.db&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="sd">/**
</span></span></span><span class="line"><span class="cl"><span class="sd"> * Output the cyclomatic complexity of each function
</span></span></span><span class="line"><span class="cl"><span class="sd"> *
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param filePath      file path
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param functionName  function name
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param complexity    cyclomatic complexity
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param startLine     function start line
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param endLine       function end line
</span></span></span><span class="line"><span class="cl"><span class="sd"> */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">out</span><span class="p">(</span><span class="n">filePath</span>: <span class="nc">string</span><span class="p">,</span><span class="w"> </span><span class="n">functionName</span>: <span class="nc">string</span><span class="p">,</span><span class="w"> </span><span class="n">complexity</span>: <span class="nc">int</span><span class="p">,</span><span class="w"> </span><span class="n">startLine</span>: <span class="nc">int</span><span class="p">,</span><span class="w"> </span><span class="n">endLine</span>: <span class="nc">int</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">db</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">default_db</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">func</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">FunctionLikeDeclaration</span><span class="p">(</span><span class="n">db</span><span class="p">),</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">File</span><span class="p">(</span><span class="n">db</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">complexity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">func</span><span class="p">.</span><span class="n">getCyclomaticComplexity</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">functionName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">func</span><span class="p">.</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">func</span><span class="p">.</span><span class="n">getLocation</span><span class="p">().</span><span class="n">getFile</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">filePath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">file</span><span class="p">.</span><span class="n">getRelativePath</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">startLine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">func</span><span class="p">.</span><span class="n">getLocation</span><span class="p">().</span><span class="n">getStartLineNumber</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">endLine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">func</span><span class="p">.</span><span class="n">getLocation</span><span class="p">().</span><span class="n">getEndLineNumber</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">output</span><span class="p">(</span><span class="n">out</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h4 id="change-effect">Change Effect</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="c1">// script
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">use</span><span class="w"> </span><span class="n">coref</span>::<span class="n">javascript</span>::<span class="o">*</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">default_db</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">JavascriptDB</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">JavascriptDB</span>::<span class="n">load</span><span class="p">(</span><span class="s">&#34;coref_javascript_src.db&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">getACallerFunction</span><span class="p">(</span><span class="n">function</span>: <span class="nc">FunctionLikeDeclaration</span><span class="p">,</span><span class="w"> </span><span class="n">callerFunction</span>: <span class="nc">FunctionLikeDeclaration</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">mayInvokeExpression</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">MayInvokeExpression</span><span class="p">(</span><span class="n">default_db</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">mayInvokeExpression</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">function</span><span class="p">.</span><span class="n">getACallSite</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">callerFunction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mayInvokeExpression</span><span class="p">.</span><span class="n">getEnclosingFunction</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">getAnEffectedFunction</span><span class="p">(</span><span class="n">function</span>: <span class="nc">FunctionLikeDeclaration</span><span class="p">,</span><span class="w"> </span><span class="n">effectedFunction</span>: <span class="nc">FunctionLikeDeclaration</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">getACallerFunction</span><span class="p">(</span><span class="n">function</span><span class="p">,</span><span class="w"> </span><span class="n">effectedFunction</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">callerFunction</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">FunctionLikeDeclaration</span><span class="p">(</span><span class="n">default_db</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">getACallerFunction</span><span class="p">(</span><span class="n">function</span><span class="p">,</span><span class="w"> </span><span class="n">callerFunction</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">getAnEffectedFunction</span><span class="p">(</span><span class="n">callerFunction</span><span class="p">,</span><span class="w"> </span><span class="n">effectedFunction</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="sd">/**
</span></span></span><span class="line"><span class="cl"><span class="sd"> * Query the effected functions according to the changed lines.
</span></span></span><span class="line"><span class="cl"><span class="sd"> *
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param function              the changed function id
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param signature             the changed function signature
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param functionPath          the changed function file path
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param startLine             the changed function start line
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param endLine               the changed function end line
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param effectedFunction      the effected function id
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param effectedSignature     the effected function signature
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param effectedFunctionPath  the effected function file path
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param effectedStartLine     the effected function start line
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param effectedEndLine       the effected function end line
</span></span></span><span class="line"><span class="cl"><span class="sd"> */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">out</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">function</span>: <span class="nc">FunctionLikeDeclaration</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">signature</span>: <span class="nc">string</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">functionPath</span>: <span class="nc">string</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">startLine</span>: <span class="nc">int</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">endLine</span>: <span class="nc">int</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">effectedFunction</span>: <span class="nc">FunctionLikeDeclaration</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">effectedSignature</span>: <span class="nc">string</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">effectedFunctionPath</span>: <span class="nc">string</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">effectedStartLine</span>: <span class="nc">int</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">effectedEndLine</span>: <span class="nc">int</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">getAnEffectedFunction</span><span class="p">(</span><span class="n">function</span><span class="p">,</span><span class="w"> </span><span class="n">effectedFunction</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">symbol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">function</span><span class="p">.</span><span class="n">getSymbol</span><span class="p">(),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">effectedSymbol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">effectedFunction</span><span class="p">.</span><span class="n">getSymbol</span><span class="p">(),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">function</span><span class="p">.</span><span class="n">getLocation</span><span class="p">(),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">effectedLocation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">effectedFunction</span><span class="p">.</span><span class="n">getLocation</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">signature</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">symbol</span><span class="p">.</span><span class="n">getDescription</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">effectedSignature</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">effectedSymbol</span><span class="p">.</span><span class="n">getDescription</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">functionPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">location</span><span class="p">.</span><span class="n">getRelativePath</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">startLine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">location</span><span class="p">.</span><span class="n">getStartLineNumber</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">endLine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">location</span><span class="p">.</span><span class="n">getEndLineNumber</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">effectedFunctionPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">effectedLocation</span><span class="p">.</span><span class="n">getRelativePath</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">effectedStartLine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">effectedLocation</span><span class="p">.</span><span class="n">getStartLineNumber</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">effectedEndLine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">effectedLocation</span><span class="p">.</span><span class="n">getEndLineNumber</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">output</span><span class="p">(</span><span class="n">out</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h3 id="xml">XML</h3>
<h4 id="getting-bean">Getting bean</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="c1">// script
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">use</span><span class="w"> </span><span class="n">coref</span>::<span class="n">xml</span>::<span class="o">*</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">schema</span><span class="w"> </span><span class="n">BeanXmlElement</span><span class="w"> </span><span class="n">extends</span><span class="w"> </span><span class="n">XmlElement</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">impl</span><span class="w"> </span><span class="n">BeanXmlElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">@</span><span class="n">data_constraint</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span> <span class="nf">__all__</span><span class="p">(</span><span class="n">db</span>: <span class="nc">XmlDB</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="o">*</span><span class="n">BeanXmlElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">XmlElement</span><span class="p">(</span><span class="n">db</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">getLocation</span><span class="p">().</span><span class="n">getFile</span><span class="p">().</span><span class="n">getRelativePath</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">path</span><span class="p">.</span><span class="n">contains</span><span class="p">(</span><span class="s">&#34;target&#34;</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;bean&#34;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="kr">yield</span><span class="w"> </span><span class="n">BeanXmlElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="n">id</span>: <span class="nc">e</span><span class="p">.</span><span class="n">id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="n">location_id</span>: <span class="nc">e</span><span class="p">.</span><span class="n">location_id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="n">parent_id</span>: <span class="nc">e</span><span class="p">.</span><span class="n">parent_id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="n">index_order</span>: <span class="nc">e</span><span class="p">.</span><span class="n">index_order</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">schema</span><span class="w"> </span><span class="n">EntryXmlElement</span><span class="w"> </span><span class="n">extends</span><span class="w"> </span><span class="n">XmlElement</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">impl</span><span class="w"> </span><span class="n">EntryXmlElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">@</span><span class="n">data_constraint</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span> <span class="nf">__all__</span><span class="p">(</span><span class="n">db</span>: <span class="nc">XmlDB</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="o">*</span><span class="n">EntryXmlElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">XmlElement</span><span class="p">(</span><span class="n">db</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;entry&#34;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="kr">yield</span><span class="w"> </span><span class="n">EntryXmlElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">id</span>: <span class="nc">e</span><span class="p">.</span><span class="n">id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">location_id</span>: <span class="nc">e</span><span class="p">.</span><span class="n">location_id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">parent_id</span>: <span class="nc">e</span><span class="p">.</span><span class="n">parent_id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">index_order</span>: <span class="nc">e</span><span class="p">.</span><span class="n">index_order</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">schema</span><span class="w"> </span><span class="n">PropertyXmlElement</span><span class="w"> </span><span class="n">extends</span><span class="w"> </span><span class="n">XmlElement</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">impl</span><span class="w"> </span><span class="n">PropertyXmlElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">@</span><span class="n">data_constraint</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span> <span class="nf">__all__</span><span class="p">(</span><span class="n">db</span>: <span class="nc">XmlDB</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="o">*</span><span class="n">PropertyXmlElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">XmlElement</span><span class="p">(</span><span class="n">db</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;property&#34;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="kr">yield</span><span class="w"> </span><span class="n">PropertyXmlElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">id</span>: <span class="nc">e</span><span class="p">.</span><span class="n">id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">location_id</span>: <span class="nc">e</span><span class="p">.</span><span class="n">location_id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">parent_id</span>: <span class="nc">e</span><span class="p">.</span><span class="n">parent_id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">index_order</span>: <span class="nc">e</span><span class="p">.</span><span class="n">index_order</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">default_db</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">XmlDB</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">XmlDB</span>::<span class="n">load</span><span class="p">(</span><span class="s">&#34;coref_xml_src.db&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// get class name
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">fn</span> <span class="nf">getClassName</span><span class="p">(</span><span class="n">bean</span>: <span class="nc">BeanXmlElement</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">string</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">attr</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">bean</span><span class="p">.</span><span class="n">getAttribute</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">attr</span><span class="p">.</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;class&#34;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">attr</span><span class="p">.</span><span class="n">getValue</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// get key
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">fn</span> <span class="nf">getKey</span><span class="p">(</span><span class="n">e</span>: <span class="nc">EntryXmlElement</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">string</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">attr</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">getAttribute</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">attr</span><span class="p">.</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;key&#34;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">attr</span><span class="p">.</span><span class="n">getValue</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// output value and class info of the bean
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">fn</span> <span class="nf">output1</span><span class="p">(</span><span class="n">className</span>: <span class="nc">string</span><span class="p">,</span><span class="w"> </span><span class="n">pName</span>: <span class="nc">string</span><span class="p">,</span><span class="w"> </span><span class="n">kName</span>: <span class="nc">string</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">db</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">default_db</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">bean</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">BeanXmlElement</span><span class="p">(</span><span class="n">db</span><span class="p">),</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">PropertyXmlElement</span><span class="p">(</span><span class="n">db</span><span class="p">),</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">EntryXmlElement</span><span class="p">(</span><span class="n">db</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">className</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getClassName</span><span class="p">(</span><span class="n">bean</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">bean</span><span class="p">.</span><span class="n">key_eq</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">getParent</span><span class="p">())</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">p</span><span class="p">.</span><span class="n">key_eq</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">getParent</span><span class="p">().</span><span class="n">getParent</span><span class="p">())</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">pName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">kName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getKey</span><span class="p">(</span><span class="n">e</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">output</span><span class="p">(</span><span class="n">output1</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h4 id="pom">POM</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="c1">// script
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">use</span><span class="w"> </span><span class="n">coref</span>::<span class="n">xml</span>::<span class="o">*</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">schema</span><span class="w"> </span><span class="n">DependencyElement</span><span class="w"> </span><span class="n">extends</span><span class="w"> </span><span class="n">XmlElement</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">impl</span><span class="w"> </span><span class="n">DependencyElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">@</span><span class="n">data_constraint</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span> <span class="nf">__all__</span><span class="p">(</span><span class="n">db</span>: <span class="nc">XmlDB</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="o">*</span><span class="n">DependencyElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="n">e</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">XmlElement</span><span class="p">(</span><span class="n">db</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">getElementName</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;dependency&#34;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="kr">yield</span><span class="w"> </span><span class="n">DependencyElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">id</span>: <span class="nc">e</span><span class="p">.</span><span class="n">id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">location_id</span>: <span class="nc">e</span><span class="p">.</span><span class="n">location_id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">parent_id</span>: <span class="nc">e</span><span class="p">.</span><span class="n">parent_id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">index_order</span>: <span class="nc">e</span><span class="p">.</span><span class="n">index_order</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">schema</span><span class="w"> </span><span class="n">GroupElement</span><span class="w"> </span><span class="n">extends</span><span class="w"> </span><span class="n">XmlElement</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">impl</span><span class="w"> </span><span class="n">GroupElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">@</span><span class="n">data_constraint</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span> <span class="nf">__all__</span><span class="p">(</span><span class="n">db</span>: <span class="nc">XmlDB</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="o">*</span><span class="n">GroupElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="n">e</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">XmlElement</span><span class="p">(</span><span class="n">db</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">getElementName</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;groupId&#34;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="kr">yield</span><span class="w"> </span><span class="n">GroupElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">id</span>: <span class="nc">e</span><span class="p">.</span><span class="n">id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">location_id</span>: <span class="nc">e</span><span class="p">.</span><span class="n">location_id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">parent_id</span>: <span class="nc">e</span><span class="p">.</span><span class="n">parent_id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">index_order</span>: <span class="nc">e</span><span class="p">.</span><span class="n">index_order</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">schema</span><span class="w"> </span><span class="n">VersionElement</span><span class="w"> </span><span class="n">extends</span><span class="w"> </span><span class="n">XmlElement</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">impl</span><span class="w"> </span><span class="n">VersionElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">@</span><span class="n">data_constraint</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span> <span class="nf">__all__</span><span class="p">(</span><span class="n">db</span>: <span class="nc">XmlDB</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="o">*</span><span class="n">VersionElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="n">e</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">XmlElement</span><span class="p">(</span><span class="n">db</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">getElementName</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;version&#34;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="kr">yield</span><span class="w"> </span><span class="n">VersionElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">id</span>: <span class="nc">e</span><span class="p">.</span><span class="n">id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">location_id</span>: <span class="nc">e</span><span class="p">.</span><span class="n">location_id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">parent_id</span>: <span class="nc">e</span><span class="p">.</span><span class="n">parent_id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">index_order</span>: <span class="nc">e</span><span class="p">.</span><span class="n">index_order</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">schema</span><span class="w"> </span><span class="n">ArtifactElement</span><span class="w"> </span><span class="n">extends</span><span class="w"> </span><span class="n">XmlElement</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">impl</span><span class="w"> </span><span class="n">ArtifactElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">@</span><span class="n">data_constraint</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span> <span class="nf">__all__</span><span class="p">(</span><span class="n">db</span>: <span class="nc">XmlDB</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="o">*</span><span class="n">ArtifactElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="n">e</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">XmlElement</span><span class="p">(</span><span class="n">db</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">getElementName</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;artifactId&#34;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="kr">yield</span><span class="w"> </span><span class="n">ArtifactElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">id</span>: <span class="nc">e</span><span class="p">.</span><span class="n">id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">location_id</span>: <span class="nc">e</span><span class="p">.</span><span class="n">location_id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">parent_id</span>: <span class="nc">e</span><span class="p">.</span><span class="n">parent_id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">index_order</span>: <span class="nc">e</span><span class="p">.</span><span class="n">index_order</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">schema</span><span class="w"> </span><span class="n">PomFile</span><span class="w"> </span><span class="n">extends</span><span class="w"> </span><span class="n">XmlFile</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">impl</span><span class="w"> </span><span class="n">PomFile</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">@</span><span class="n">data_constraint</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span> <span class="nf">__all__</span><span class="p">(</span><span class="n">db</span>: <span class="nc">XmlDB</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="o">*</span><span class="n">PomFile</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="n">f</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">XmlFile</span><span class="p">(</span><span class="n">db</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">getFileName</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;pom.xml&#34;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="kr">yield</span><span class="w"> </span><span class="n">PomFile</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">id</span>: <span class="nc">f</span><span class="p">.</span><span class="n">id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">file_name</span>: <span class="nc">f</span><span class="p">.</span><span class="n">file_name</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">relative_path</span>: <span class="nc">f</span><span class="p">.</span><span class="n">relative_path</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// output relative path of the file, referenced jar name and version
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">fn</span> <span class="nf">out</span><span class="p">(</span><span class="n">fileName</span>: <span class="nc">string</span><span class="p">,</span><span class="w"> </span><span class="n">m1</span>: <span class="nc">string</span><span class="p">,</span><span class="w"> </span><span class="n">m2</span>: <span class="nc">string</span><span class="p">,</span><span class="w"> </span><span class="n">m3</span>: <span class="nc">string</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">db</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">XmlDB</span>::<span class="n">load</span><span class="p">(</span><span class="s">&#34;coref_xml_src.db&#34;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">f</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">PomFile</span><span class="p">(</span><span class="n">db</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">e1</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">GroupElement</span><span class="p">(</span><span class="n">db</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">e2</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">VersionElement</span><span class="p">(</span><span class="n">db</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">e3</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">ArtifactElement</span><span class="p">(</span><span class="n">db</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">c1</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">XmlCharacter</span><span class="p">(</span><span class="n">db</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">c2</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">XmlCharacter</span><span class="p">(</span><span class="n">db</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">c3</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">XmlCharacter</span><span class="p">(</span><span class="n">db</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">p</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">DependencyElement</span><span class="p">(</span><span class="n">db</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">key_eq</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">getLocation</span><span class="p">().</span><span class="n">getFile</span><span class="p">())</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">fileName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">.</span><span class="n">getRelativePath</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">p</span><span class="p">.</span><span class="n">key_eq</span><span class="p">(</span><span class="n">e1</span><span class="p">.</span><span class="n">getParent</span><span class="p">())</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">e1</span><span class="p">.</span><span class="n">key_eq</span><span class="p">(</span><span class="n">c1</span><span class="p">.</span><span class="n">getBelongedElement</span><span class="p">())</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">m1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c1</span><span class="p">.</span><span class="n">getText</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">p</span><span class="p">.</span><span class="n">key_eq</span><span class="p">(</span><span class="n">e2</span><span class="p">.</span><span class="n">getParent</span><span class="p">())</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">e2</span><span class="p">.</span><span class="n">key_eq</span><span class="p">(</span><span class="n">c2</span><span class="p">.</span><span class="n">getBelongedElement</span><span class="p">())</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">m2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c2</span><span class="p">.</span><span class="n">getText</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">p</span><span class="p">.</span><span class="n">key_eq</span><span class="p">(</span><span class="n">e3</span><span class="p">.</span><span class="n">getParent</span><span class="p">())</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">e3</span><span class="p">.</span><span class="n">key_eq</span><span class="p">(</span><span class="n">c3</span><span class="p">.</span><span class="n">getBelongedElement</span><span class="p">())</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">m3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c3</span><span class="p">.</span><span class="n">getText</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">output</span><span class="p">(</span><span class="n">out</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h4 id="rpc">RPC</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="c1">// script
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">use</span><span class="w"> </span><span class="n">coref</span>::<span class="n">xml</span>::<span class="o">*</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// select XmlElement containing &#34;mobileService&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">schema</span><span class="w"> </span><span class="n">MobileServiceXmlElement</span><span class="w"> </span><span class="n">extends</span><span class="w"> </span><span class="n">XmlElement</span><span class="p">{}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">impl</span><span class="w"> </span><span class="n">MobileServiceXmlElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">@</span><span class="n">data_constraint</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span> <span class="nf">__all__</span><span class="p">(</span><span class="n">db</span>: <span class="nc">XmlDB</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="o">*</span><span class="n">MobileServiceXmlElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">XmlElement</span><span class="p">(</span><span class="n">db</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">getElementName</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;mobileService&#34;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="kr">yield</span><span class="w"> </span><span class="n">MobileServiceXmlElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">id</span>: <span class="nc">e</span><span class="p">.</span><span class="n">id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">location_id</span>: <span class="nc">e</span><span class="p">.</span><span class="n">location_id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">parent_id</span>: <span class="nc">e</span><span class="p">.</span><span class="n">parent_id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">index_order</span>: <span class="nc">e</span><span class="p">.</span><span class="n">index_order</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span> <span class="nf">getServiceBeanValue</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">string</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">getAttribute</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;serviceBean&#34;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">getValue</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// select XmlElement containing &#34;sofa:extension&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">schema</span><span class="w"> </span><span class="n">SofaExtensionXmlElement</span><span class="w"> </span><span class="n">extends</span><span class="w"> </span><span class="n">XmlElement</span><span class="p">{}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">impl</span><span class="w"> </span><span class="n">SofaExtensionXmlElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">@</span><span class="n">data_constraint</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span> <span class="nf">__all__</span><span class="p">(</span><span class="n">db</span>: <span class="nc">XmlDB</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="o">*</span><span class="n">SofaExtensionXmlElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">XmlElement</span><span class="p">(</span><span class="n">db</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;sofa:extension&#34;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="kr">yield</span><span class="w"> </span><span class="n">SofaExtensionXmlElement</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">id</span>: <span class="nc">e</span><span class="p">.</span><span class="n">id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">location_id</span>: <span class="nc">e</span><span class="p">.</span><span class="n">location_id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">parent_id</span>: <span class="nc">e</span><span class="p">.</span><span class="n">parent_id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">index_order</span>: <span class="nc">e</span><span class="p">.</span><span class="n">index_order</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">out</span><span class="p">(</span><span class="n">value</span>: <span class="nc">string</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">db</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">XmlDB</span>::<span class="n">load</span><span class="p">(</span><span class="s">&#34;coref_xml_src.db&#34;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">MobileServiceXmlElement</span><span class="p">(</span><span class="n">db</span><span class="p">),</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">SofaExtensionXmlElement</span><span class="p">(</span><span class="n">db</span><span class="p">),</span><span class="w"> </span><span class="n">ancestor</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">getAnAncestor</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">key_eq</span><span class="p">(</span><span class="n">ancestor</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">getServiceBeanValue</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">output</span><span class="p">(</span><span class="n">out</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h3 id="go">Go</h3>
<h4 id="message-of-all-files">Message of All Files</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="c1">// script
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">use</span><span class="w"> </span><span class="n">coref</span>::<span class="n">go</span>::<span class="o">*</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">default_db</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">GoDB</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">GoDB</span>::<span class="n">load</span><span class="p">(</span><span class="s">&#34;coref_go_src.db&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="sd">/**
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param name          file name
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param funcCount     function/method quantity
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param totallines    total lines of file
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param codelines     code line of file
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param commentlines  comment line of fine
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param md5           md5 of this file
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param sha256        sha256 of this file
</span></span></span><span class="line"><span class="cl"><span class="sd"> */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">out</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">name</span>: <span class="nc">string</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">funcCount</span>: <span class="nc">int</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">totallines</span>: <span class="nc">int</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">codelines</span>: <span class="nc">int</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">commentlines</span>: <span class="nc">int</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">md5</span>: <span class="nc">string</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">sha256</span>: <span class="nc">string</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">f</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">File</span><span class="p">(</span><span class="n">default_db</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">.</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">funcCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">.</span><span class="n">getFunctionCount</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">md5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">.</span><span class="n">getMd5Sum</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">sha256</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">.</span><span class="n">getSha256Sum</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">totallines</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">.</span><span class="n">getLineInfo</span><span class="p">().</span><span class="n">getNumberOfTotalLines</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">codelines</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">.</span><span class="n">getLineInfo</span><span class="p">().</span><span class="n">getNumberOfCodeLines</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">commentlines</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">.</span><span class="n">getLineInfo</span><span class="p">().</span><span class="n">getNumberOfCommentLines</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">output</span><span class="p">(</span><span class="n">out</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h4 id="methods-and-corresponding-comments">Methods and Corresponding Comments</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="c1">// script
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">use</span><span class="w"> </span><span class="n">coref</span>::<span class="n">go</span>::<span class="o">*</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">default_db</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">GoDB</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">GoDB</span>::<span class="n">load</span><span class="p">(</span><span class="s">&#34;coref_go_src.db&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// Define a predicate called &#39;out&#39; with parameters fileName, funcName, funcComment, and signature
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">fn</span> <span class="nf">out</span><span class="p">(</span><span class="n">fileName</span>: <span class="nc">string</span><span class="p">,</span><span class="w"> </span><span class="n">funcName</span>: <span class="nc">string</span><span class="p">,</span><span class="w"> </span><span class="n">funcComment</span>: <span class="nc">string</span><span class="p">,</span><span class="w"> </span><span class="n">signature</span>: <span class="nc">string</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// Check if there exists a Function object &#39;func&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">func</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Function</span><span class="p">(</span><span class="n">default_db</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// Get the name of the file the function belongs to and assign it to the variable &#39;fileName&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">            </span><span class="n">fileName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">func</span><span class="p">.</span><span class="n">getBelongsFile</span><span class="p">().</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// Get the name of the function and assign it to the variable &#39;funcName&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">            </span><span class="n">funcName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">func</span><span class="p">.</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// Get the associated comment string for the function and assign it to the variable &#39;funcComment&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">            </span><span class="n">funcComment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">func</span><span class="p">.</span><span class="n">getAssociatedCommentString</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// Get the function type signature and assign it to the variable &#39;signature&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">            </span><span class="n">signature</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">func</span><span class="p">.</span><span class="n">getFunctionTypeSignature</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">output</span><span class="p">(</span><span class="n">out</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h4 id="cyclomatic-complexity-2">Cyclomatic complexity</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="c1">// script
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">use</span><span class="w"> </span><span class="n">coref</span>::<span class="n">go</span>::<span class="o">*</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">default_db</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">GoDB</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">GoDB</span>::<span class="n">load</span><span class="p">(</span><span class="s">&#34;coref_go_src.db&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="sd">/**
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param name: file name
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param func: function name
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param cmplx: function cyclomatic complexity
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param sl,el,sc,ec: function location info
</span></span></span><span class="line"><span class="cl"><span class="sd"> */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">out</span><span class="p">(</span><span class="n">name</span>: <span class="nc">string</span><span class="p">,</span><span class="w"> </span><span class="n">func</span>: <span class="nc">string</span><span class="p">,</span><span class="w"> </span><span class="n">cmplx</span>: <span class="nc">int</span><span class="p">,</span><span class="w"> </span><span class="n">sl</span>: <span class="nc">int</span><span class="p">,</span><span class="w"> </span><span class="n">el</span>: <span class="nc">int</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">f</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">GoFile</span><span class="p">(</span><span class="n">default_db</span><span class="p">()),</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Function</span><span class="p">(</span><span class="n">default_db</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="o">!</span><span class="n">f</span><span class="p">.</span><span class="n">isAutoGenereatedFile</span><span class="p">())</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">f</span><span class="p">.</span><span class="n">key_eq</span><span class="p">(</span><span class="n">function</span><span class="p">.</span><span class="n">getBelongsFile</span><span class="p">())</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">.</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">func</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">function</span><span class="p">.</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">cmplx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">function</span><span class="p">.</span><span class="n">getCyclomaticComplexity</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">sl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">function</span><span class="p">.</span><span class="n">getLocation</span><span class="p">().</span><span class="n">getStartLineNumber</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">el</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">function</span><span class="p">.</span><span class="n">getLocation</span><span class="p">().</span><span class="n">getEndLineNumber</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">output</span><span class="p">(</span><span class="n">out</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h2 id="query-debugging-and-optimization-techniques">Query Debugging and Optimization Techniques</h2>
<p>When running GödelScript scripts, it is common to encounter issues with excessively long run times. Here, we provide some basic methods for diagnosis and solutions.</p>
<h3 id="schema-parameters-causing-excessive-cartesian-products">Schema Parameters Causing Excessive Cartesian Products</h3>
<p>By default, function parameters without the <code>@inline</code> annotation are considered &ldquo;qualification&rdquo; conditions, not true input values.</p>
<p>For example, in the following case, <code>get</code> receives a <code>Class</code> type parameter, but the actual final compilation result will resemble the code below:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">fn</span> <span class="nf">check</span><span class="p">(</span><span class="n">class</span>: <span class="nc">Class</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">class</span><span class="p">.</span><span class="n">getName</span><span class="p">().</span><span class="n">contains</span><span class="p">(</span><span class="s">&#34;io&#34;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// Actual compilation result
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">fn</span> <span class="nf">check</span><span class="p">(</span><span class="n">class</span>: <span class="nc">Class</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// Actually, it needs to fetch the entire Class set first
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">__temp_class</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Class</span>::<span class="n">__all__</span><span class="p">(</span><span class="n">__all_data__</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">class</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">__temp_class</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">class</span><span class="p">.</span><span class="n">getName</span><span class="p">().</span><span class="n">contains</span><span class="p">(</span><span class="s">&#34;io&#34;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>Therefore, when passing multiple schema types as parameters, there will be Cartesian products of multiple full schema sets, leading to a significant increase in space and time costs.
The solution is simple: just add an <code>@inline</code> annotation:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="o">@</span><span class="n">inline</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">check</span><span class="p">(</span><span class="n">class</span>: <span class="nc">Class</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">class</span><span class="p">.</span><span class="n">getName</span><span class="p">().</span><span class="n">contains</span><span class="p">(</span><span class="s">&#34;io&#34;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">example</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">class</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Class</span><span class="p">(</span><span class="n">default_java_db</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">check</span><span class="p">(</span><span class="n">class</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// The inline annotation will forcibly inline the function into the statement during the code generation stage, avoiding multiple table loads
</span></span></span><span class="line"><span class="cl"><span class="c1">// The actual compilation result is similar to
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">fn</span> <span class="nf">example</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">class</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Class</span><span class="p">(</span><span class="n">default_java_db</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">class</span><span class="p">.</span><span class="n">getName</span><span class="p">().</span><span class="n">contains</span><span class="p">(</span><span class="s">&#34;io&#34;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h3 id="multiple-for-loops-causing-excessive-cartesian-products">Multiple <code>for</code> Loops Causing Excessive Cartesian Products</h3>
<p>In some cases, it is unavoidable to use multiple layers of <code>for</code> loops to load multiple tables for joint queries, causing severe inflation of Cartesian products. The number of Cartesian product results can be reduced by decreasing (filtering) the size of the sets in advance, as shown in the example:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">fn</span> <span class="nf">getByIndex</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">Expression</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">db</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">default_java_db</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="n">e</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Expression</span><span class="p">(</span><span class="n">db</span><span class="p">),</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Parameter</span><span class="p">(</span><span class="n">db</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">getIndex</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">key_eq</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">getValueByIndex</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="n">e</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>In this example, e and p form a Cartesian product, causing the intermediate process to take too long.
The set i is actually obtained from a method of p, and in actual use, this set is very small, much smaller than the full set of Parameter. Therefore, the retrieval of the i set can be extracted as a separate function to produce a small set, avoiding Cartesian product computations between large sets while ensuring result equivalence:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">fn</span> <span class="nf">getAllParameterIndex</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="o">*</span><span class="n">int</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">db</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">default_java_db</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Parameter</span><span class="p">(</span><span class="n">db</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="kr">yield</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">getIndex</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">getByIndex</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">Expression</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">db</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">default_java_db</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="n">e</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Expression</span><span class="p">(</span><span class="n">db</span><span class="p">),</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">getAllParameterIndex</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">key_eq</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">getValueByIndex</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">e</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>The Cartesian product of e and p becomes e and i. Operationally, the cost of the Cartesian product is reduced, and the <code>getIndex</code> operation is advanced, rather than taking place after the Cartesian product, significantly improving performance.</p>
<h3 id="do-not-overuse-inline--must-use-inline-optimization-strategy">Do Not Overuse <code>@inline</code> / Must Use <code>@inline</code> Optimization Strategy</h3>
<p>The underlying mechanism of inline functions is to <strong>expand at the call site</strong>. If the function does not have a large number of schema parameters and is called in many places, inline may lead to <strong>code bloat and an exponential increase in the number of redundant calculations</strong>, which may sometimes be counterproductive in reducing runtime.
If you must use inline, such as to avoid <code>ungrounded</code>, but find that using inline slows down the execution speed, you can split the embedded statements into predicates to prevent code bloat caused by expansion.</p>
<p>In the following example, <code>getValueByAttributeNameByDefaultValue</code> is marked with inline to prevent <code>attributeName</code> from being identified as <code>ungrounded</code>. Subsequently, a conditional statement was added in the if branch, causing the execution time to increase from 3 seconds to 35 seconds:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">impl</span><span class="w"> </span><span class="n">XmlElementBase</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="o">@</span><span class="n">inline</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">fn</span> <span class="nf">getValueByAttributeNameByDefaultValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">attributeName</span>: <span class="nc">string</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">string</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">hasAttribute</span><span class="p">(</span><span class="n">attributeName</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="c1">// return self.getValueByAttributeName(attributeName)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">      </span><span class="c1">// Changed to the following statement:
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">      </span><span class="kd">let</span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">getValueByAttributeName</span><span class="p">(</span><span class="n">attributeName</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">If</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;n/a&#34;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="s">&#34;&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s">&#34;n/a&#34;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="n">value</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="bp">self</span><span class="p">.</span><span class="n">hasAttribute</span><span class="p">(</span><span class="n">attributeName</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="s">&#34;null&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>As you can see, adding a level of assignment and a conditional statement, where this function is called nearly 20 times in the subsequent context, resulted in the code being expanded nearly 20 times. This also caused a magnitude difference in performance. At this point, you can extract the changed statement into a separate function. Since the extracted function does not use complex types as parameters, performance is not lost without inline, and after extraction, the result is as follows:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">impl</span><span class="w"> </span><span class="n">XmlElementBase</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">fn</span> <span class="nf">getTransValueByAttributeName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">attributeName</span>: <span class="nc">string</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">string</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">getValueByAttributeName</span><span class="p">(</span><span class="n">attributeName</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;n/a&#34;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&#34;&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s">&#34;n/a&#34;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">value</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="o">@</span><span class="n">inline</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">fn</span> <span class="nf">getValueByAttributeNameByDefaultValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">attributeName</span>: <span class="nc">string</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">string</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">hasAttribute</span><span class="p">(</span><span class="n">attributeName</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">getTransValueByAttributeName</span><span class="p">(</span><span class="n">attributeName</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="bp">self</span><span class="p">.</span><span class="n">hasAttribute</span><span class="p">(</span><span class="n">attributeName</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="s">&#34;null&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>This way, the execution time is reduced from 35 seconds back to 3 seconds, meeting expectations.</p>
<h2 id="using-query-scripts-locally">Using Query Scripts Locally</h2>
<p>For instructions on using query scripts on your machine, see <a href="./3_install_and_run.md">Installation, Configuration, and Running</a>.</p>

      </div>
      








  
  
  
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

      
    
        

        
          
        

        
        
      


<footer id="article-footer">
  <time id="article-last-updated" datetime="2024-04-09"><i class="icon icon-calendar"></i>&nbsp;Last updated: 2024-04-09</time>

  
    <a id="article-prev-link" href="/docs/codefuse-query-quickstart/"><i class="icon icon-prev icon-colored"></i> Prev</a>
  

  
    <a id="article-next-link"  href="/docs/codefuse-query-toolchain/">Next <i class="icon icon-next icon-colored"></i></a>
  
</footer>
    </article>
    <aside id="toc">
  <span class="btn-close"><i class="icon icon-close"></i></span>
  <div class="sticky">
    <strong><i class="icon icon-toc"></i> On this page</strong>
    <nav id="TableOfContents">
  <ul>
    <li><a href="#index">Index</a></li>
    <li><a href="#basic-concepts-and-syntax-of-gödelscript">Basic Concepts and Syntax of GödelScript</a>
      <ul>
        <li><a href="#introduction">Introduction</a></li>
        <li><a href="#basic-program-structure">Basic Program Structure</a></li>
        <li><a href="#basic-types-and-built-in-compiler-functions">Basic Types and Built-in Compiler Functions</a></li>
        <li><a href="#functions">Functions</a></li>
        <li><a href="#statements">Statements</a></li>
        <li><a href="#schema">Schema</a></li>
        <li><a href="#database">Database</a></li>
        <li><a href="#trait">Trait</a></li>
        <li><a href="#import">Import</a></li>
        <li><a href="#query">Query</a></li>
        <li><a href="#ungrounded-error">Ungrounded Error</a></li>
      </ul>
    </li>
    <li><a href="#query-examples">Query Examples</a>
      <ul>
        <li><a href="#java">Java</a></li>
        <li><a href="#python">Python</a></li>
        <li><a href="#javascript">JavaScript</a></li>
        <li><a href="#xml">XML</a></li>
        <li><a href="#go">Go</a></li>
      </ul>
    </li>
    <li><a href="#query-debugging-and-optimization-techniques">Query Debugging and Optimization Techniques</a>
      <ul>
        <li><a href="#schema-parameters-causing-excessive-cartesian-products">Schema Parameters Causing Excessive Cartesian Products</a></li>
        <li><a href="#multiple-for-loops-causing-excessive-cartesian-products">Multiple <code>for</code> Loops Causing Excessive Cartesian Products</a></li>
        <li><a href="#do-not-overuse-inline--must-use-inline-optimization-strategy">Do Not Overuse <code>@inline</code> / Must Use <code>@inline</code> Optimization Strategy</a></li>
      </ul>
    </li>
    <li><a href="#using-query-scripts-locally">Using Query Scripts Locally</a></li>
  </ul>
</nav>
  </div>
</aside>
  </main>
</div>

    <footer id="site-footer">
  
  <div id="site-footer-copyright">
    <a href="https://github.com/codefuse-ai" target="_blank">
      <i class="icon icon-copyright"></i> 2023-2024 codefuse-ai
    </a>
  </div>

  
  <div id="site-footer-social">

    

    

    
    <a href="https://github.com/codefuse-ai" target="_blank" aria-label="github url">
      <i class="icon icon-github icon-colored"></i>
    </a>
    

    

  </div>

  
  <div id="site-footer-fund">

    

    

  </div>

  
  <div id="site-footer-love">
    Made with <i class="icon icon-love icon-colored"></i> &nbsp;from&nbsp;<a href="https://docura.github.io/" target="_blank">Docura</a>
  </div>
</footer>
    






<script type="text/javascript" src="/js/base.min.js"></script>



  
  <script src="/js/component/docsearch.min.js"></script>
  <script type="application/javascript">
      docsearch({
          container: '#site-header-search',
          appId: '',
          indexName: '',
          apiKey: '',
      });
  </script>


<script type="application/javascript">
    if('serviceWorker' in navigator) {
        navigator.serviceWorker.register('/sw.js?2024-04-09')
            .catch(function(err) {console.error('ServiceWorker registration failed: ', err);});
    }
</script>
  </body>
</html>